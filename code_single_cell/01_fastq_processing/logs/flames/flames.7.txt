**** Job starts ****
2024-08-07 06:02:09
**** JHPCE info ****
User: sparthib
Job id: 8996744
Job name: flames
Node name: compute-164
Task id: 7
10X_D200-EP1-1_B1
ln: failed to create symbolic link '/dcs04/hicks/data/sparthib/retina_single_cell_lrs/05_flames_output/10X_D200-EP1-1_B1/align2genome.bam': File exists
ln: failed to create symbolic link '/dcs04/hicks/data/sparthib/retina_single_cell_lrs/05_flames_output/10X_D200-EP1-1_B1/align2genome.bam.bai': File exists
Loading conda_R/4.4.x
To install colorout use: remotes::install_github("jalvesaq/colorout")
Registered S3 method overwritten by 'GGally':
  method from   
  +.gg   ggplot2
06:17:20 AM Wed Aug 07 2024 Start running
Skipping Demultiplexing step...
Please make sure the ` /dcs04/hicks/data/sparthib/retina_single_cell_lrs/05_flames_output//10X_D200-EP1-1_B1/matched_reads.fastq `` is the the demultiplexing output from previous FLAEMS call.
Running FLAMES pipeline...
#### Input parameters:
{
  "pipeline_parameters": {
    "seed": [2022],
    "threads": [20],
    "do_barcode_demultiplex": [false],
    "do_gene_quantification": [false],
    "do_genome_alignment": [false],
    "do_isoform_identification": [true],
    "bambu_isoform_identification": [true],
    "multithread_isoform_identification": [true],
    "do_read_realignment": [true],
    "do_transcript_quantification": [true]
  },
  "barcode_parameters": {
    "max_bc_editdistance": [2],
    "max_flank_editdistance": [8],
    "pattern": {
      "primer": ["CTACACGACGCTCTTCCGATCT"],
      "BC": ["NNNNNNNNNNNNNNNN"],
      "UMI": ["NNNNNNNNNNNN"],
      "polyT": ["TTTTTTTTT"]
    },
    "TSO_seq": ["CCCATGTACTCTGCGTTGATACCACTGCTT"],
    "TSO_prime": [3],
    "full_length_only": [false]
  },
  "isoform_parameters": {
    "generate_raw_isoform": [false],
    "max_dist": [10],
    "max_ts_dist": [100],
    "max_splice_match_dist": [10],
    "min_fl_exon_len": [40],
    "max_site_per_splice": [3],
    "min_sup_cnt": [5],
    "min_cnt_pct": [0.001],
    "min_sup_pct": [0.2],
    "bambu_trust_reference": [true],
    "strand_specific": [0],
    "remove_incomp_reads": [4],
    "downsample_ratio": [1]
  },
  "alignment_parameters": {
    "use_junctions": [true],
    "no_flank": [false]
  },
  "realign_parameters": {
    "use_annotation": [true]
  },
  "transcript_counting": {
    "min_tr_coverage": [0.4],
    "min_read_coverage": [0.4]
  }
} 
gene annotation: /dcs04/hicks/data/sparthib/references/genome/GENCODE/gencode.v44.chr_patch_hapl_scaff.annotation.gtf 
genome fasta: /dcs04/hicks/data/sparthib/references/genome/GENCODE/GRCh38.p14.genome.fa 
input fastq: /dcs04/hicks/data/sparthib/retina_single_cell_lrs/05_flames_output//10X_D200-EP1-1_B1/matched_reads.fastq 
output directory: /dcs04/hicks/data/sparthib/retina_single_cell_lrs/05_flames_output//10X_D200-EP1-1_B1 
minimap2 path: 
k8 path: 
#### Skip aligning reads to genome
#### Skip gene quantification and UMI deduplication
06:17:20 AM Wed Aug 07 2024 Start isoform identificaiton
06:17:20 AM Wed Aug 07 2024 find_isoform
--- Start generating read class files ---
'getOption("repos")' replaces Bioconductor standard repositories, see
'help("repositories", package = "BiocManager")' for details.
Replacement repositories:
    CRAN: https://cran.rstudio.com
[06:35:23] WARNING: src/learner.cc:553: 
  If you are loading a serialized model (like pickle in Python, RDS in R) generated by
  older XGBoost, please export the model by calling `Booster.save_model` from that version
  first, then load it back in current version. See:

    https://xgboost.readthedocs.io/en/latest/tutorials/saving_model.html

  for more details about differences between saving model and serializing.

[06:35:23] WARNING: src/learner.cc:553: 
  If you are loading a serialized model (like pickle in Python, RDS in R) generated by
  older XGBoost, please export the model by calling `Booster.save_model` from that version
  first, then load it back in current version. See:

    https://xgboost.readthedocs.io/en/latest/tutorials/saving_model.html

  for more details about differences between saving model and serializing.

[06:35:23] WARNING: src/learner.cc:553: 
  If you are loading a serialized model (like pickle in Python, RDS in R) generated by
  older XGBoost, please export the model by calling `Booster.save_model` from that version
  first, then load it back in current version. See:

    https://xgboost.readthedocs.io/en/latest/tutorials/saving_model.html

  for more details about differences between saving model and serializing.

[06:35:23] WARNING: src/learner.cc:553: 
  If you are loading a serialized model (like pickle in Python, RDS in R) generated by
  older XGBoost, please export the model by calling `Booster.save_model` from that version
  first, then load it back in current version. See:

    https://xgboost.readthedocs.io/en/latest/tutorials/saving_model.html

  for more details about differences between saving model and serializing.

[06:51:55] WARNING: src/learner.cc:553: 
  If you are loading a serialized model (like pickle in Python, RDS in R) generated by
  older XGBoost, please export the model by calling `Booster.save_model` from that version
  first, then load it back in current version. See:

    https://xgboost.readthedocs.io/en/latest/tutorials/saving_model.html

  for more details about differences between saving model and serializing.

[06:51:56] WARNING: src/learner.cc:553: 
  If you are loading a serialized model (like pickle in Python, RDS in R) generated by
  older XGBoost, please export the model by calling `Booster.save_model` from that version
  first, then load it back in current version. See:

    https://xgboost.readthedocs.io/en/latest/tutorials/saving_model.html

  for more details about differences between saving model and serializing.

Detected 2 warnings across the samples during read class construction. Access warnings with metadata(bambuOutput)$warnings
--- Start extending annotations ---
Using a novel discovery rate (NDR) of: 0.134
--- Start isoform quantification ---
--- Finished running Bambu ---
Import genomic features from the file as a GRanges object ... OK
Prepare the 'metadata' data frame ... OK
Make the TxDb object ... OK
07:03:42 AM Wed Aug 07 2024 Isoform identificaiton done
#### Realigning deduplicated reads to transcript using minimap2
07:03:42 AM Wed Aug 07 2024 minimap2_realign
[M::mm_idx_gen::2.472*1.53] collected minimizers
[M::mm_idx_gen::3.863*1.77] sorted minimizers
[M::main::3.884*1.77] loaded/built the index for 94484 target sequence(s)
[M::mm_mapopt_update::4.193*1.71] mid_occ = 82
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 94484
[M::mm_idx_stat::4.393*1.68] distinct minimizers: 15977620 (48.27% are singletons); average occurrences: 2.699; average spacing: 5.377; total length: 231894273
[M::worker_pipeline::35.153*13.11] mapped 489032 sequences
[M::worker_pipeline::50.728*15.27] mapped 490406 sequences
[M::worker_pipeline::64.440*16.32] mapped 487956 sequences
[M::worker_pipeline::79.802*17.05] mapped 486631 sequences
[M::worker_pipeline::93.859*17.54] mapped 489782 sequences
[M::worker_pipeline::108.098*17.89] mapped 487529 sequences
[M::worker_pipeline::124.158*18.20] mapped 486668 sequences
[M::worker_pipeline::137.247*18.39] mapped 489307 sequences
[M::worker_pipeline::152.750*18.58] mapped 487862 sequences
[M::worker_pipeline::168.475*18.73] mapped 487883 sequences
[M::worker_pipeline::184.284*18.85] mapped 490333 sequences
[M::worker_pipeline::199.927*18.96] mapped 488984 sequences
[M::worker_pipeline::217.723*19.06] mapped 488462 sequences
[M::worker_pipeline::231.976*19.07] mapped 491768 sequences
[M::worker_pipeline::248.940*19.15] mapped 488787 sequences
[M::worker_pipeline::263.328*19.21] mapped 488043 sequences
[M::worker_pipeline::280.282*19.27] mapped 492729 sequences
[M::worker_pipeline::295.319*19.32] mapped 490309 sequences
[M::worker_pipeline::308.560*19.36] mapped 491830 sequences
[M::worker_pipeline::324.942*19.40] mapped 496489 sequences
[M::worker_pipeline::340.962*19.44] mapped 495960 sequences
[M::worker_pipeline::356.938*19.47] mapped 498300 sequences
[M::worker_pipeline::371.174*19.50] mapped 498703 sequences
[M::worker_pipeline::386.279*19.49] mapped 496855 sequences
[M::worker_pipeline::400.870*19.51] mapped 495669 sequences
[M::worker_pipeline::415.680*19.54] mapped 496379 sequences
[M::worker_pipeline::431.643*19.56] mapped 494709 sequences
[M::worker_pipeline::448.166*19.59] mapped 494166 sequences
[M::worker_pipeline::464.741*19.61] mapped 494266 sequences
[M::worker_pipeline::480.277*19.63] mapped 493029 sequences
[M::worker_pipeline::496.388*19.61] mapped 492082 sequences
[M::worker_pipeline::513.159*19.63] mapped 493538 sequences
[M::worker_pipeline::529.113*19.51] mapped 493721 sequences
[M::worker_pipeline::547.916*19.52] mapped 491793 sequences
[M::worker_pipeline::564.452*19.54] mapped 490974 sequences
[M::worker_pipeline::580.718*19.56] mapped 490806 sequences
[M::worker_pipeline::595.874*19.58] mapped 490619 sequences
[M::worker_pipeline::611.646*19.59] mapped 492715 sequences
[M::worker_pipeline::627.266*19.61] mapped 490810 sequences
[M::worker_pipeline::643.883*19.62] mapped 490440 sequences
[M::worker_pipeline::659.521*19.61] mapped 489478 sequences
[M::worker_pipeline::675.967*19.62] mapped 488745 sequences
[M::worker_pipeline::693.551*19.64] mapped 490302 sequences
[M::worker_pipeline::711.027*19.65] mapped 490840 sequences
[M::worker_pipeline::725.293*19.66] mapped 489329 sequences
[M::worker_pipeline::742.167*19.67] mapped 489427 sequences
[M::worker_pipeline::757.081*19.67] mapped 489335 sequences
[M::worker_pipeline::774.142*19.68] mapped 488131 sequences
[M::worker_pipeline::788.891*19.68] mapped 489196 sequences
[M::worker_pipeline::803.723*19.69] mapped 489276 sequences
[M::worker_pipeline::819.347*19.70] mapped 488664 sequences
[M::worker_pipeline::835.434*19.71] mapped 487693 sequences
[M::worker_pipeline::850.559*19.68] mapped 487747 sequences
[M::worker_pipeline::869.008*19.69] mapped 489743 sequences
[M::worker_pipeline::883.811*19.68] mapped 488454 sequences
[M::worker_pipeline::902.130*19.69] mapped 487946 sequences
[M::worker_pipeline::918.758*19.69] mapped 489788 sequences
[M::worker_pipeline::933.086*19.70] mapped 487813 sequences
[M::worker_pipeline::948.932*19.71] mapped 488721 sequences
[M::worker_pipeline::962.626*19.70] mapped 489780 sequences
[M::worker_pipeline::980.163*19.70] mapped 487306 sequences
[M::worker_pipeline::995.200*19.67] mapped 485811 sequences
[M::worker_pipeline::1012.767*19.68] mapped 487573 sequences
[M::worker_pipeline::1026.942*19.68] mapped 487068 sequences
[M::worker_pipeline::1044.072*19.69] mapped 488532 sequences
[M::worker_pipeline::1059.096*19.69] mapped 488368 sequences
[M::worker_pipeline::1075.025*19.70] mapped 487929 sequences
[M::worker_pipeline::1089.007*19.71] mapped 488779 sequences
[M::worker_pipeline::1104.737*19.72] mapped 486104 sequences
[M::worker_pipeline::1120.897*19.72] mapped 487324 sequences
[M::worker_pipeline::1136.687*19.73] mapped 489405 sequences
[M::worker_pipeline::1154.091*19.72] mapped 488606 sequences
[M::worker_pipeline::1156.338*19.68] mapped 184882 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: /users/sparthib/minimap2/minimap2 -ax map-ont -p 0.9 --end-bonus 10 -N 3 -t 20 --seed 2022 /dcs04/hicks/data/sparthib/retina_single_cell_lrs/05_flames_output//10X_D200-EP1-1_B1/transcript_assembly.fa /dcs04/hicks/data/sparthib/retina_single_cell_lrs/05_flames_output//10X_D200-EP1-1_B1/matched_reads.fastq
[M::main] Real time: 1156.449 sec; CPU: 22760.851 sec; Peak RSS: 4.875 GB
[bam_sort_core] merging from 26 files and 1 in-memory blocks...
#### Generating transcript count matrix
08:07:05 AM Wed Aug 07 2024 quantify transcripts 
Found realignment file(s): 	realign2transcript.bam
	Counter({'unmapped': 12890684, 'counted_reads': 12874062, 'no_good_match': 6963831, 'not_enough_coverage': 2755793, 'ambigious_reads': 49})
shared splice chain: {'ENSG00000272901.5', 'ENSG00000272835.3'}
(2250, 4269, 4410, 5463)
shared splice chain: {'ENSG00000272901.5', 'ENSG00000272835.3'}
(2299, 4269, 4410, 5463)
shared splice chain: {'ENSG00000276220.1', 'ENSG00000273642.1', 'ENSG00000278365.1', 'ENSG00000274359.1', 'ENSG00000276766.1', 'ENSG00000275724.1', 'ENSG00000275605.1', 'ENSG00000277722.1'}
(77309, 77534, 77609, 80353, 80431, 81230)
shared splice chain: {'ENSG00000275086.1', 'ENSG00000274073.1', 'ENSG00000276323.1', 'ENSG00000276263.1', 'ENSG00000276296.1'}
(81589, 82445, 82664, 82745, 82815, 84546, 84617, 88934, 89193, 89739)
shared splice chain: {'ENSG00000277600.4', 'ENSG00000274176.4', 'ENSG00000274941.4', 'ENSG00000276082.4'}
(112822, 117777, 117852, 117967, 118035, 118290, 118365, 118508, 118598, 118854, 118983, 119085, 119181, 120446, 120666, 120758, 120892, 121449, 121506, 122995, 123383, 123467, 123591, 124407, 124606, 127075, 127175, 127277, 127476, 127716, 127849, 128564, 128690, 130159)
shared splice chain: {'ENSG00000275935.1', 'ENSG00000278516.1', 'ENSG00000276774.1', 'ENSG00000276628.1', 'ENSG00000277457.1'}
(130791, 131613, 131876, 133132, 133312, 134414)
shared splice chain: {'ENSG00000277025.4', 'ENSG00000278322.4', 'ENSG00000277923.4', 'ENSG00000278519.4', 'ENSG00000275118.4'}
(149239, 153595, 153772, 155603, 155964, 158517, 158677, 162156, 162283, 163184, 163314, 163400, 163479, 164302)
shared splice chain: {'ENSG00000278081.3', 'ENSG00000275323.3', 'ENSG00000274005.3', 'ENSG00000277079.3', 'ENSG00000274626.3', 'ENSG00000278270.4', 'ENSG00000277359.3'}
(175870, 176141, 176263, 176468, 176591, 181257, 181444, 182379)
shared splice chain: {'ENSG00000277359.3', 'ENSG00000274005.3', 'ENSG00000278081.3', 'ENSG00000277079.3'}
(175870, 176141, 176263, 176468, 176591, 181257, 181444, 181534)
shared splice chain: {'ENSG00000277365.3', 'ENSG00000273397.4'}
(8659, 9404, 9520, 12950)
shared splice chain: {'ENSG00000292344.1', 'ENSG00000182378.15'}
(276394, 281481, 281684, 284166, 284314, 288732, 288869, 290647, 290776, 291498, 291654, 293034, 293218, 299096)
shared splice chain: {'ENSG00000226179.6', 'ENSG00000292342.1'}
(321248, 321682)
shared splice chain: {'ENSG00000292327.1', 'ENSG00000167393.18'}
(334517, 338603, 338710, 338777, 338896, 340764, 340940, 341306, 341396, 341882, 341931, 345515, 345672, 346173, 346260, 346700, 346775, 347233, 347336, 347589, 347693, 361404, 361590, 386367)
shared splice chain: {'ENSG00000292343.1', 'ENSG00000197976.12'}
(1591769, 1593443, 1594224, 1595383, 1595532, 1599191, 1599432, 1600658)
shared splice chain: {'ENSG00000214717.12', 'ENSG00000292345.1'}
(2490772, 2500816)
shared splice chain: {'ENSG00000214717.12', 'ENSG00000292345.1'}
(2490772, 2500310)
shared splice chain: {'ENSG00000289007.2', 'ENSG00000292360.1'}
(2567292, 2583843)
There were 50 or more warnings (use warnings() to see the first 50)
R version 4.4.1 Patched (2024-08-05 r86983)
Platform: x86_64-conda-linux-gnu
Running under: Rocky Linux 9.4 (Blue Onyx)

Matrix products: default
BLAS:   /jhpce/shared/community/core/conda_R/4.4.x/R/lib64/R/lib/libRblas.so 
LAPACK: /jhpce/shared/community/core/conda_R/4.4.x/R/lib64/R/lib/libRlapack.so;  LAPACK version 3.12.0

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
 [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       

time zone: US/Eastern
tzcode source: system (glibc)

attached base packages:
[1] stats4    stats     graphics  grDevices utils     datasets  methods  
[8] base     

other attached packages:
[1] IRanges_2.39.2      S4Vectors_0.43.2    BiocGenerics_0.51.0
[4] sessioninfo_1.2.2   FLAMES_1.11.0      

loaded via a namespace (and not attached):
  [1] BiocIO_1.15.0               bitops_1.0-8               
  [3] filelock_1.0.3              tibble_3.2.1               
  [5] R.oo_1.26.0                 basilisk.utils_1.17.2      
  [7] bambu_3.7.0                 graph_1.83.0               
  [9] XML_3.99-0.17               rpart_4.1.23               
 [11] httr2_1.0.2                 lifecycle_1.0.4            
 [13] edgeR_4.3.7                 doParallel_1.0.17          
 [15] globals_0.16.3              lattice_0.22-6             
 [17] ensembldb_2.29.0            OrganismDbi_1.47.0         
 [19] MultiAssayExperiment_1.31.4 backports_1.5.0            
 [21] magrittr_2.0.3              limma_3.61.9               
 [23] Hmisc_5.1-3                 rmarkdown_2.27             
 [25] yaml_2.3.10                 metapod_1.13.0             
 [27] reticulate_1.38.0           ggbio_1.53.0               
 [29] cowplot_1.1.3               DBI_1.2.3                  
 [31] RColorBrewer_1.1-3          abind_1.4-5                
 [33] zlibbioc_1.51.1             GenomicRanges_1.57.1       
 [35] purrr_1.0.2                 R.utils_2.12.3             
 [37] AnnotationFilter_1.29.0     biovizBase_1.53.0          
 [39] RCurl_1.98-1.16             nnet_7.3-19                
 [41] rappdirs_0.3.3              VariantAnnotation_1.51.0   
 [43] circlize_0.4.16             GenomeInfoDbData_1.2.12    
 [45] ggrepel_0.9.5               irlba_2.3.5.1              
 [47] listenv_0.9.1               dqrng_0.4.1                
 [49] parallelly_1.38.0           DelayedMatrixStats_1.27.2  
 [51] codetools_0.2-20            DropletUtils_1.25.2        
 [53] DelayedArray_0.31.11        xml2_1.3.6                 
 [55] scuttle_1.15.2              tidyselect_1.2.1           
 [57] shape_1.4.6.1               UCSC.utils_1.1.0           
 [59] viridis_0.6.5               ScaledMatrix_1.13.0        
 [61] BiocFileCache_2.13.0        matrixStats_1.3.0          
 [63] base64enc_0.1-3             GenomicAlignments_1.41.0   
 [65] jsonlite_1.8.8              BiocNeighbors_1.23.0       
 [67] GetoptLong_1.0.5            Formula_1.2-5              
 [69] scater_1.33.4               iterators_1.0.14           
 [71] foreach_1.5.2               progress_1.2.3             
 [73] tools_4.4.1                 Rcpp_1.0.13                
 [75] glue_1.7.0                  gridExtra_2.3              
 [77] SparseArray_1.5.31          xfun_0.46                  
 [79] MatrixGenerics_1.17.0       GenomeInfoDb_1.41.1        
 [81] dplyr_1.1.4                 HDF5Array_1.33.5           
 [83] withr_3.0.1                 BiocManager_1.30.23        
 [85] fastmap_1.2.0               GGally_2.2.1               
 [87] basilisk_1.17.2             bluster_1.15.0             
 [89] rhdf5filters_1.17.0         fansi_1.0.6                
 [91] rsvd_1.0.5                  digest_0.6.36              
 [93] R6_2.5.1                    colorspace_2.1-1           
 [95] dichromat_2.0-0.1           biomaRt_2.61.2             
 [97] RSQLite_2.3.7               R.methodsS3_1.8.2          
 [99] utf8_1.2.4                  tidyr_1.3.1                
[101] generics_0.1.3              data.table_1.15.4          
[103] rtracklayer_1.65.0          prettyunits_1.2.0          
[105] httr_1.4.7                  htmlwidgets_1.6.4          
[107] S4Arrays_1.5.6              ggstats_0.6.0              
[109] pkgconfig_2.0.3             gtable_0.3.5               
[111] blob_1.2.4                  ComplexHeatmap_2.21.0      
[113] SingleCellExperiment_1.27.2 XVector_0.45.0             
[115] htmltools_0.5.8.1           RBGL_1.81.0                
[117] ProtGenerics_1.37.1         clue_0.3-65                
[119] scales_1.3.0                Biobase_2.65.0             
[121] png_0.1-8                   scran_1.33.1               
[123] knitr_1.48                  rstudioapi_0.16.0          
[125] reshape2_1.4.4              rjson_0.2.21               
[127] checkmate_2.3.2             curl_5.2.1                 
[129] cachem_1.1.0                rhdf5_2.49.0               
[131] GlobalOptions_0.1.2         stringr_1.5.1              
[133] vipor_0.4.7                 parallel_4.4.1             
[135] foreign_0.8-87              AnnotationDbi_1.67.0       
[137] restfulr_0.0.15             pillar_1.9.0               
[139] grid_4.4.1                  vctrs_0.6.5                
[141] BiocSingular_1.21.2         dbplyr_2.5.0               
[143] beachmat_2.21.5             cluster_2.1.6              
[145] beeswarm_0.4.0              htmlTable_2.4.3            
[147] evaluate_0.24.0             GenomicFeatures_1.57.0     
[149] cli_3.6.3                   locfit_1.5-9.10            
[151] compiler_4.4.1              Rsamtools_2.21.0           
[153] rlang_1.1.4                 crayon_1.5.3               
[155] ggbeeswarm_0.7.2            plyr_1.8.9                 
[157] stringi_1.8.4               viridisLite_0.4.2          
[159] BiocParallel_1.39.0         txdbmaker_1.1.1            
[161] munsell_0.5.1               Biostrings_2.73.1          
[163] lazyeval_0.2.2              Matrix_1.7-0               
[165] dir.expiry_1.13.0           BSgenome_1.73.0            
[167] hms_1.1.3                   sparseMatrixStats_1.17.2   
[169] bit64_4.0.5                 future_1.34.0              
[171] ggplot2_3.5.1               Rhdf5lib_1.27.0            
[173] KEGGREST_1.45.1             statmod_1.5.0              
[175] SummarizedExperiment_1.35.1 igraph_2.0.3               
[177] memoise_2.0.1               bit_4.0.5                  
[179] xgboost_1.7.8.1            
**** Job ends ****
2024-08-07 08:17:05
