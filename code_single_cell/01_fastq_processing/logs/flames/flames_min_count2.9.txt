**** Job starts ****
2024-09-21 19:29:38
**** JHPCE info ****
User: sparthib
Job id: 9812233
Job name: flames
Node name: compute-057
Array task ID: 9
10x_D200-EP1-2_A1
Loading conda_R/4.4.x
Registered S3 method overwritten by 'GGally':
  method from   
  +.gg   ggplot2
07:30:05 PM Sat Sep 21 2024 Start running
Skipping Demultiplexing step...
Please make sure the ` /dcs04/hicks/data/sparthib/retina_single_cell_lrs/05b_flames_output_min_cnt_1/10x_D200-EP1-2_A1/matched_reads.fastq `` is the demultiplexing output from previous FLAMES call.
Running FLAMES pipeline...
#### Input parameters:
{
  "pipeline_parameters": {
    "seed": [2022],
    "threads": [20],
    "do_barcode_demultiplex": [false],
    "do_gene_quantification": [false],
    "do_genome_alignment": [true],
    "do_isoform_identification": [true],
    "bambu_isoform_identification": [true],
    "multithread_isoform_identification": [false],
    "do_read_realignment": [true],
    "do_transcript_quantification": [true]
  },
  "barcode_parameters": {
    "max_bc_editdistance": [2],
    "max_flank_editdistance": [8],
    "pattern": {
      "primer": ["CTACACGACGCTCTTCCGATCT"],
      "BC": ["NNNNNNNNNNNNNNNN"],
      "UMI": ["NNNNNNNNNNNN"],
      "polyT": ["TTTTTTTTT"]
    },
    "TSO_seq": ["CCCATGTACTCTGCGTTGATACCACTGCTT"],
    "TSO_prime": [3],
    "full_length_only": [false]
  },
  "isoform_parameters": {
    "generate_raw_isoform": [false],
    "max_dist": [10],
    "max_ts_dist": [100],
    "max_splice_match_dist": [10],
    "min_fl_exon_len": [40],
    "max_site_per_splice": [3],
    "min_sup_cnt": [2],
    "min_cnt_pct": [0.001],
    "min_sup_pct": [0.2],
    "bambu_trust_reference": [true],
    "strand_specific": [0],
    "remove_incomp_reads": [4],
    "downsample_ratio": [1]
  },
  "alignment_parameters": {
    "use_junctions": [true],
    "no_flank": [false]
  },
  "realign_parameters": {
    "use_annotation": [true]
  },
  "transcript_counting": {
    "min_tr_coverage": [0.4],
    "min_read_coverage": [0.4]
  }
} 
gene annotation: /dcs04/hicks/data/sparthib/references/genome/GENCODE/gencode.v44.chr_patch_hapl_scaff.annotation.gtf 
genome fasta: /dcs04/hicks/data/sparthib/references/genome/GENCODE/GRCh38.p14.genome.fa 
input fastq: /dcs04/hicks/data/sparthib/retina_single_cell_lrs/05b_flames_output_min_cnt_1/10x_D200-EP1-2_A1/matched_reads.fastq 
output directory: /dcs04/hicks/data/sparthib/retina_single_cell_lrs/05b_flames_output_min_cnt_1/10x_D200-EP1-2_A1 
minimap2 path: 
k8 path: 
#### Aligning reads to genome using minimap2
07:30:05 PM Sat Sep 21 2024 minimap2_align
[M::mm_idx_gen::84.864*1.79] collected minimizers
[M::mm_idx_gen::105.280*3.88] sorted minimizers
[M::main::105.281*3.88] loaded/built the index for 706 target sequence(s)
[M::mm_mapopt_update::109.977*3.76] mid_occ = 2173
[M::mm_idx_stat] kmer size: 14; skip: 5; is_hpc: 0; #seq: 706
[M::mm_idx_stat::111.666*3.72] distinct minimizers: 65649907 (22.01% are singletons); average occurrences: 16.223; average spacing: 3.091; total length: 3291585349
[M::worker_pipeline::938.894*17.35] mapped 493917 sequences
[M::worker_pipeline::1623.401*18.36] mapped 493626 sequences
[M::worker_pipeline::2302.475*18.77] mapped 492639 sequences
[M::worker_pipeline::2980.513*19.00] mapped 493626 sequences
[M::worker_pipeline::3665.480*19.14] mapped 492963 sequences
[M::worker_pipeline::4339.616*19.23] mapped 496402 sequences
[M::worker_pipeline::5010.088*19.30] mapped 505936 sequences
[M::worker_pipeline::5677.145*19.36] mapped 502802 sequences
[M::worker_pipeline::6344.859*19.40] mapped 503438 sequences
[M::worker_pipeline::7011.489*19.43] mapped 502303 sequences
[M::worker_pipeline::7678.037*19.46] mapped 501954 sequences
[M::worker_pipeline::8346.320*19.48] mapped 499761 sequences
[M::worker_pipeline::9011.888*19.50] mapped 501495 sequences
[M::worker_pipeline::9685.338*19.51] mapped 498735 sequences
[M::worker_pipeline::10360.724*19.53] mapped 498927 sequences
[M::worker_pipeline::11024.987*19.54] mapped 497992 sequences
[M::worker_pipeline::11690.503*19.56] mapped 498678 sequences
[M::worker_pipeline::12359.403*19.57] mapped 498453 sequences
[M::worker_pipeline::13022.780*19.58] mapped 497965 sequences
[M::worker_pipeline::13694.800*19.58] mapped 498313 sequences
[M::worker_pipeline::14363.393*19.59] mapped 497448 sequences
[M::worker_pipeline::15030.969*19.60] mapped 498115 sequences
[M::worker_pipeline::15696.871*19.61] mapped 496945 sequences
[M::worker_pipeline::16363.523*19.61] mapped 497645 sequences
[M::worker_pipeline::17036.316*19.62] mapped 497156 sequences
[M::worker_pipeline::17706.658*19.62] mapped 498310 sequences
[M::worker_pipeline::18372.884*19.63] mapped 498270 sequences
[M::worker_pipeline::19042.007*19.63] mapped 497610 sequences
[M::worker_pipeline::19714.851*19.64] mapped 498719 sequences
[M::worker_pipeline::20384.279*19.64] mapped 498359 sequences
[M::worker_pipeline::21060.449*19.65] mapped 500255 sequences
[M::worker_pipeline::21732.108*19.65] mapped 499293 sequences
[M::worker_pipeline::22410.678*19.65] mapped 500986 sequences
[M::worker_pipeline::23091.115*19.66] mapped 497862 sequences
[M::worker_pipeline::23772.047*19.66] mapped 502271 sequences
[M::worker_pipeline::24444.280*19.66] mapped 500562 sequences
[M::worker_pipeline::25122.792*19.66] mapped 506264 sequences
[M::worker_pipeline::25801.145*19.66] mapped 503913 sequences
[M::worker_pipeline::26461.791*19.66] mapped 512712 sequences
[M::worker_pipeline::27054.594*19.66] mapped 468947 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: /users/sparthib/minimap2/minimap2 -ax splice -t 20 -k14 --secondary=no --seed 2022 --junc-bed /dcs04/hicks/data/sparthib/retina_single_cell_lrs/05b_flames_output_min_cnt_1/10x_D200-EP1-2_A1/tmp_splice_anno.bed12 --junc-bonus 1 /dcs04/hicks/data/sparthib/references/genome/GENCODE/GRCh38.p14.genome.fa /dcs04/hicks/data/sparthib/retina_single_cell_lrs/05b_flames_output_min_cnt_1/10x_D200-EP1-2_A1/matched_reads.fastq
[M::main] Real time: 27055.232 sec; CPU: 531911.378 sec; Peak RSS: 29.911 GB
[bam_sort_core] merging from 14 files and 1 in-memory blocks...
#### Skip gene quantification and UMI deduplication
03:44:21 AM Sun Sep 22 2024 Start isoform identificaiton
03:44:21 AM Sun Sep 22 2024 find_isoform
--- Start generating read class files ---
'getOption("repos")' replaces Bioconductor standard repositories, see
'help("repositories", package = "BiocManager")' for details.
Replacement repositories:
    CRAN: https://cran.rstudio.com
[04:09:45] WARNING: src/learner.cc:553: 
  If you are loading a serialized model (like pickle in Python, RDS in R) generated by
  older XGBoost, please export the model by calling `Booster.save_model` from that version
  first, then load it back in current version. See:

    https://xgboost.readthedocs.io/en/latest/tutorials/saving_model.html

  for more details about differences between saving model and serializing.

[04:09:46] WARNING: src/learner.cc:553: 
  If you are loading a serialized model (like pickle in Python, RDS in R) generated by
  older XGBoost, please export the model by calling `Booster.save_model` from that version
  first, then load it back in current version. See:

    https://xgboost.readthedocs.io/en/latest/tutorials/saving_model.html

  for more details about differences between saving model and serializing.

[04:09:46] WARNING: src/learner.cc:553: 
  If you are loading a serialized model (like pickle in Python, RDS in R) generated by
  older XGBoost, please export the model by calling `Booster.save_model` from that version
  first, then load it back in current version. See:

    https://xgboost.readthedocs.io/en/latest/tutorials/saving_model.html

  for more details about differences between saving model and serializing.

[04:09:46] WARNING: src/learner.cc:553: 
  If you are loading a serialized model (like pickle in Python, RDS in R) generated by
  older XGBoost, please export the model by calling `Booster.save_model` from that version
  first, then load it back in current version. See:

    https://xgboost.readthedocs.io/en/latest/tutorials/saving_model.html

  for more details about differences between saving model and serializing.

[04:47:37] WARNING: src/learner.cc:553: 
  If you are loading a serialized model (like pickle in Python, RDS in R) generated by
  older XGBoost, please export the model by calling `Booster.save_model` from that version
  first, then load it back in current version. See:

    https://xgboost.readthedocs.io/en/latest/tutorials/saving_model.html

  for more details about differences between saving model and serializing.

[04:47:39] WARNING: src/learner.cc:553: 
  If you are loading a serialized model (like pickle in Python, RDS in R) generated by
  older XGBoost, please export the model by calling `Booster.save_model` from that version
  first, then load it back in current version. See:

    https://xgboost.readthedocs.io/en/latest/tutorials/saving_model.html

  for more details about differences between saving model and serializing.

Detected 2 warnings across the samples during read class construction. Access warnings with metadata(bambuOutput)$warnings
--- Start extending annotations ---
Using a novel discovery rate (NDR) of: 0.103
--- Start isoform quantification ---
--- Finished running Bambu ---
Import genomic features from the file as a GRanges object ... OK
Prepare the 'metadata' data frame ... OK
Make the TxDb object ... OK
05:12:39 AM Sun Sep 22 2024 Isoform identificaiton done
#### Realigning deduplicated reads to transcript using minimap2
05:12:39 AM Sun Sep 22 2024 minimap2_realign
[M::mm_idx_gen::6.161*1.44] collected minimizers
[M::mm_idx_gen::6.859*2.32] sorted minimizers
[M::main::6.912*2.31] loaded/built the index for 84539 target sequence(s)
[M::mm_mapopt_update::7.319*2.23] mid_occ = 78
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 84539
[M::mm_idx_stat::7.648*2.18] distinct minimizers: 15595802 (49.29% are singletons); average occurrences: 2.559; average spacing: 5.375; total length: 214466825
[M::worker_pipeline::95.550*15.61] mapped 493917 sequences
[M::worker_pipeline::150.890*16.84] mapped 493626 sequences
[M::worker_pipeline::206.323*17.40] mapped 492639 sequences
[M::worker_pipeline::261.240*17.73] mapped 493626 sequences
[M::worker_pipeline::316.854*17.94] mapped 492963 sequences
[M::worker_pipeline::372.064*18.09] mapped 496402 sequences
[M::worker_pipeline::426.978*18.20] mapped 505936 sequences
[M::worker_pipeline::482.799*18.29] mapped 502802 sequences
[M::worker_pipeline::538.228*18.36] mapped 503438 sequences
[M::worker_pipeline::593.059*18.41] mapped 502303 sequences
[M::worker_pipeline::649.980*18.46] mapped 501954 sequences
[M::worker_pipeline::704.790*18.50] mapped 499761 sequences
[M::worker_pipeline::760.046*18.53] mapped 501495 sequences
[M::worker_pipeline::816.715*18.56] mapped 498735 sequences
[M::worker_pipeline::871.693*18.58] mapped 498927 sequences
[M::worker_pipeline::926.890*18.61] mapped 497992 sequences
[M::worker_pipeline::982.559*18.62] mapped 498678 sequences
[M::worker_pipeline::1037.463*18.64] mapped 498453 sequences
[M::worker_pipeline::1093.052*18.66] mapped 497965 sequences
[M::worker_pipeline::1149.306*18.67] mapped 498313 sequences
[M::worker_pipeline::1204.009*18.68] mapped 497448 sequences
[M::worker_pipeline::1259.128*18.70] mapped 498115 sequences
[M::worker_pipeline::1315.251*18.71] mapped 496945 sequences
[M::worker_pipeline::1370.332*18.71] mapped 497645 sequences
[M::worker_pipeline::1425.044*18.72] mapped 497156 sequences
[M::worker_pipeline::1481.329*18.73] mapped 498310 sequences
[M::worker_pipeline::1536.862*18.74] mapped 498270 sequences
[M::worker_pipeline::1591.821*18.75] mapped 497610 sequences
[M::worker_pipeline::1646.877*18.75] mapped 498719 sequences
[M::worker_pipeline::1702.127*18.76] mapped 498359 sequences
[M::worker_pipeline::1757.277*18.77] mapped 500255 sequences
[M::worker_pipeline::1812.422*18.77] mapped 499293 sequences
[M::worker_pipeline::1867.393*18.78] mapped 500986 sequences
[M::worker_pipeline::1922.803*18.78] mapped 497862 sequences
[M::worker_pipeline::1978.842*18.79] mapped 502271 sequences
[M::worker_pipeline::2034.247*18.79] mapped 500562 sequences
[M::worker_pipeline::2089.602*18.80] mapped 506264 sequences
[M::worker_pipeline::2145.469*18.80] mapped 503913 sequences
[M::worker_pipeline::2199.989*18.80] mapped 512712 sequences
[M::worker_pipeline::2236.412*18.73] mapped 468947 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: /users/sparthib/minimap2/minimap2 -ax map-ont -p 0.9 --end-bonus 10 -N 3 -t 20 --seed 2022 /dcs04/hicks/data/sparthib/retina_single_cell_lrs/05b_flames_output_min_cnt_1/10x_D200-EP1-2_A1/transcript_assembly.fa /dcs04/hicks/data/sparthib/retina_single_cell_lrs/05b_flames_output_min_cnt_1/10x_D200-EP1-2_A1/matched_reads.fastq
[M::main] Real time: 2236.699 sec; CPU: 41894.589 sec; Peak RSS: 4.849 GB
[bam_sort_core] merging from 18 files and 1 in-memory blocks...
#### Generating transcript count matrix
06:36:22 AM Sun Sep 22 2024 quantify transcripts 
Found realignment file(s): 	realign2transcript.bam
	Counter({'counted_reads': 7552902, 'unmapped': 6998257, 'no_good_match': 3762582, 'not_enough_coverage': 1627790, 'ambigious_reads': 36})
shared splice chain: {'ENSG00000272901.5', 'ENSG00000272835.3', 'ENSG00000274112.2'}
(2250, 4269, 4410, 5463)
shared splice chain: {'ENSG00000272901.5', 'ENSG00000272835.3'}
(2299, 4269, 4410, 5463)
shared splice chain: {'ENSG00000276766.1', 'ENSG00000277722.1', 'ENSG00000274359.1', 'ENSG00000273642.1', 'ENSG00000278365.1', 'ENSG00000275605.1', 'ENSG00000276061.4', 'ENSG00000276220.1', 'ENSG00000275724.1'}
(77309, 77534, 77609, 80353, 80431, 81230)
shared splice chain: {'ENSG00000276296.1', 'ENSG00000276323.1', 'ENSG00000275086.1', 'ENSG00000273833.1', 'ENSG00000274073.1', 'ENSG00000276263.1'}
(81589, 82445, 82664, 82745, 82815, 84546, 84617, 88934, 89193, 89739)
shared splice chain: {'ENSG00000277600.4', 'ENSG00000276082.4', 'ENSG00000274941.4', 'ENSG00000274176.4'}
(112822, 117777, 117852, 117967, 118035, 118290, 118365, 118508, 118598, 118854, 118983, 119085, 119181, 120446, 120666, 120758, 120892, 121449, 121506, 122995, 123383, 123467, 123591, 124407, 124606, 127075, 127175, 127277, 127476, 127716, 127849, 128564, 128690, 130159)
shared splice chain: {'ENSG00000277457.1', 'ENSG00000276628.1', 'ENSG00000278257.1', 'ENSG00000276774.1', 'ENSG00000275935.1', 'ENSG00000278516.1'}
(130791, 131613, 131876, 133132, 133312, 134414)
shared splice chain: {'ENSG00000278322.4', 'ENSG00000278519.4', 'ENSG00000275118.4', 'ENSG00000277733.4', 'ENSG00000277025.4'}
(149239, 153595, 153772, 155603, 155964, 158517, 158677, 162156, 162283, 163184, 163314, 163400, 163479, 164302)
shared splice chain: {'ENSG00000277359.3', 'ENSG00000277079.3', 'ENSG00000275323.3', 'ENSG00000274005.3', 'ENSG00000274626.3', 'ENSG00000278270.4', 'ENSG00000278081.3'}
(175870, 176141, 176263, 176468, 176591, 181257, 181444, 182379)
shared splice chain: {'ENSG00000274616.4', 'ENSG00000277600.4'}
(128690, 130108)
shared splice chain: {'ENSG00000277365.3', 'ENSG00000273397.4'}
(8659, 9404, 9520, 12950)
shared splice chain: {'ENSG00000280512.2', 'ENSG00000282953.1'}
(28662, 32252, 32338, 33067, 33230, 34582, 34747, 36562, 36711, 39015, 39138, 41628, 41797, 42980, 43176, 44314, 44484, 48223, 48345, 51686, 51798, 52032, 52163, 54248, 54362, 59029)
shared splice chain: {'ENSG00000290527.1', 'ENSG00000290534.1'}
(10396, 11067, 11224, 13179, 13384, 16904, 17066, 17187, 17288, 18202)
shared splice chain: {'ENSG00000292343.1', 'ENSG00000197976.12'}
(1591769, 1593443, 1594224, 1595383, 1595532, 1599191, 1599432, 1600658)
shared splice chain: {'ENSG00000292345.1', 'ENSG00000214717.12'}
(2490772, 2500310)
shared splice chain: {'ENSG00000002586.20', 'ENSG00000292348.1'}
(2691427, 2714421, 2714454, 2717604, 2717652, 2719660, 2719705, 2720355, 2720424, 2722626, 2722674, 2723313, 2723364, 2726259, 2726373, 2738199, 2738256, 2740778)
Error in .local(x, ...) : strand values must be in '+' '-' '*'
Calls: sc_long_pipeline ... new_GRanges -> normarg_strand -> strand -> strand -> .local
In addition: There were 50 or more warnings (use warnings() to see the first 50)
Execution halted
**** Job ends ****
2024-09-22 06:55:11
