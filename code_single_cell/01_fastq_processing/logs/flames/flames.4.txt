**** Job starts ****
2024-08-27 15:25:09
**** JHPCE info ****
User: sparthib
Job id: 9567299
Job name: flames
Node name: compute-113
Task id: 4
10x_D100-EP1_B2
Loading conda_R/4.4.x
To install colorout use: remotes::install_github("jalvesaq/colorout")
Registered S3 method overwritten by 'GGally':
  method from   
  +.gg   ggplot2
03:25:51 PM Tue Aug 27 2024 Start running
Skipping Demultiplexing step...
Please make sure the ` /dcs04/hicks/data/sparthib/retina_single_cell_lrs/05_flames_output//10x_D100-EP1_B2/matched_reads.fastq `` is the demultiplexing output from previous FLAMES call.
Running FLAMES pipeline...
#### Input parameters:
{
  "pipeline_parameters": {
    "seed": [2022],
    "threads": [20],
    "do_barcode_demultiplex": [false],
    "do_gene_quantification": [true],
    "do_genome_alignment": [false],
    "do_isoform_identification": [true],
    "bambu_isoform_identification": [true],
    "multithread_isoform_identification": [true],
    "do_read_realignment": [true],
    "do_transcript_quantification": [true]
  },
  "barcode_parameters": {
    "max_bc_editdistance": [2],
    "max_flank_editdistance": [8],
    "pattern": {
      "primer": ["CTACACGACGCTCTTCCGATCT"],
      "BC": ["NNNNNNNNNNNNNNNN"],
      "UMI": ["NNNNNNNNNNNN"],
      "polyT": ["TTTTTTTTT"]
    },
    "TSO_seq": ["CCCATGTACTCTGCGTTGATACCACTGCTT"],
    "TSO_prime": [3],
    "full_length_only": [false]
  },
  "isoform_parameters": {
    "generate_raw_isoform": [false],
    "max_dist": [10],
    "max_ts_dist": [100],
    "max_splice_match_dist": [10],
    "min_fl_exon_len": [40],
    "max_site_per_splice": [3],
    "min_sup_cnt": [5],
    "min_cnt_pct": [0.001],
    "min_sup_pct": [0.2],
    "bambu_trust_reference": [true],
    "strand_specific": [0],
    "remove_incomp_reads": [4],
    "downsample_ratio": [1]
  },
  "alignment_parameters": {
    "use_junctions": [true],
    "no_flank": [false]
  },
  "realign_parameters": {
    "use_annotation": [true]
  },
  "transcript_counting": {
    "min_tr_coverage": [0.4],
    "min_read_coverage": [0.4]
  }
} 
gene annotation: /dcs04/hicks/data/sparthib/references/genome/GENCODE/gencode.v44.chr_patch_hapl_scaff.annotation.gtf 
genome fasta: /dcs04/hicks/data/sparthib/references/genome/GENCODE/GRCh38.p14.genome.fa 
input fastq: /dcs04/hicks/data/sparthib/retina_single_cell_lrs/05_flames_output//10x_D100-EP1_B2/matched_reads.fastq 
output directory: /dcs04/hicks/data/sparthib/retina_single_cell_lrs/05_flames_output//10x_D100-EP1_B2 
minimap2 path: 
k8 path: 
#### Skip aligning reads to genome
03:25:51 PM Tue Aug 27 2024 Start gene quantification and UMI deduplication
03:25:51 PM Tue Aug 27 2024 quantify genes 
Found genome alignment file(s): 	align2genome.bam
[E::idx_find_and_load] Could not retrieve index file for '/dcs04/hicks/data/sparthib/retina_single_cell_lrs/05_flames_output//10x_D100-EP1_B2/align2genome.bam'
[E::idx_find_and_load] Could not retrieve index file for '/dcs04/hicks/data/sparthib/retina_single_cell_lrs/05_flames_output//10x_D100-EP1_B2/align2genome.bam'
Error in value[[3L]](cond) : Error when quantifying genes:
Traceback (most recent call last):
  File "/jhpce/shared/community/core/conda_R/4.4.x/R/lib64/R/site-library/FLAMES/python/count_gene.py", line 485, in quantification
    quantify_gene(in_bam, annotation, n_process)
  File "/jhpce/shared/community/core/conda_R/4.4.x/R/lib64/R/site-library/FLAMES/python/count_gene.py", line 198, in quantify_gene
    [x for x in independent_gene_set_generator(in_gtf_df, in_bam, threads=n_process)]
  File "/jhpce/shared/community/core/conda_R/4.4.x/R/lib64/R/site-library/FLAMES/python/count_gene.py", line 198, in <listcomp>
    [x for x in independent_gene_set_generator(in_gtf_df, in_bam, threads=n_process)]
  File "/jhpce/shared/community/core/conda_R/4.4.x/R/lib64/R/site-library/FLAMES/python/count_gene.py", line 606, in independent_gene_set_generator
    yield from _yield_genes_per_chr(gtf_df[gtf_df.chr_name==chr], bam)
  File "/jhpce/shared/community/core/conda_R/4.4.x/R/lib64/R/site-library/FLAMES/python/count_g
Calls: sc_long_pipeline ... tryCatch -> tryCatchList -> tryCatchOne -> <Anonymous>
Execution halted
**** Job ends ****
2024-08-27 15:28:12
