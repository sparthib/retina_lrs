**** Job starts ****
2024-08-27 11:50:48
**** JHPCE info ****
User: sparthib
Job id: 9566582
Job name: flames
Node name: compute-158
Task id: 1
10x_D100-EP1_A1
Loading conda_R/4.4.x
To install colorout use: remotes::install_github("jalvesaq/colorout")
Registered S3 method overwritten by 'GGally':
  method from   
  +.gg   ggplot2
11:51:01 AM Tue Aug 27 2024 Start running
Skipping Demultiplexing step...
Please make sure the ` /dcs04/hicks/data/sparthib/retina_single_cell_lrs/05_flames_output//10x_D100-EP1_A1/matched_reads.fastq `` is the demultiplexing output from previous FLAMES call.
Running FLAMES pipeline...
#### Input parameters:
{
  "pipeline_parameters": {
    "seed": [2022],
    "threads": [20],
    "do_barcode_demultiplex": [false],
    "do_gene_quantification": [true],
    "do_genome_alignment": [false],
    "do_isoform_identification": [false],
    "bambu_isoform_identification": [false],
    "multithread_isoform_identification": [false],
    "do_read_realignment": [false],
    "do_transcript_quantification": [false]
  },
  "barcode_parameters": {
    "max_bc_editdistance": [2],
    "max_flank_editdistance": [8],
    "pattern": {
      "primer": ["CTACACGACGCTCTTCCGATCT"],
      "BC": ["NNNNNNNNNNNNNNNN"],
      "UMI": ["NNNNNNNNNNNN"],
      "polyT": ["TTTTTTTTT"]
    },
    "TSO_seq": ["CCCATGTACTCTGCGTTGATACCACTGCTT"],
    "TSO_prime": [3],
    "full_length_only": [false]
  },
  "isoform_parameters": {
    "generate_raw_isoform": [false],
    "max_dist": [10],
    "max_ts_dist": [100],
    "max_splice_match_dist": [10],
    "min_fl_exon_len": [40],
    "max_site_per_splice": [3],
    "min_sup_cnt": [5],
    "min_cnt_pct": [0.001],
    "min_sup_pct": [0.2],
    "bambu_trust_reference": [true],
    "strand_specific": [0],
    "remove_incomp_reads": [4],
    "downsample_ratio": [1]
  },
  "alignment_parameters": {
    "use_junctions": [true],
    "no_flank": [false]
  },
  "realign_parameters": {
    "use_annotation": [true]
  },
  "transcript_counting": {
    "min_tr_coverage": [0.4],
    "min_read_coverage": [0.4]
  }
} 
gene annotation: /dcs04/hicks/data/sparthib/references/genome/GENCODE/gencode.v44.chr_patch_hapl_scaff.annotation.gtf 
genome fasta: /dcs04/hicks/data/sparthib/references/genome/GENCODE/GRCh38.p14.genome.fa 
input fastq: /dcs04/hicks/data/sparthib/retina_single_cell_lrs/05_flames_output//10x_D100-EP1_A1/matched_reads.fastq 
output directory: /dcs04/hicks/data/sparthib/retina_single_cell_lrs/05_flames_output//10x_D100-EP1_A1 
minimap2 path: 
k8 path: 
#### Skip aligning reads to genome
11:51:01 AM Tue Aug 27 2024 Start gene quantification and UMI deduplication
11:51:01 AM Tue Aug 27 2024 quantify genes 
Found genome alignment file(s): 	align2genome.bam
+ /users/sparthib/.cache/R/basilisk/1.17.2/0/bin/conda create --yes --prefix /users/sparthib/.cache/R/basilisk/1.17.2/FLAMES/1.11.1/flames_env 'python=3.10' --quiet -c conda-forge -c bioconda -c defaults --override-channels
Retrieving notices: ...working... done
Channels:
 - conda-forge
 - bioconda
 - defaults
Platform: linux-64
Collecting package metadata (repodata.json): ...working... done
Solving environment: ...working... done

## Package Plan ##

  environment location: /users/sparthib/.cache/R/basilisk/1.17.2/FLAMES/1.11.1/flames_env

  added / updated specs:
    - python=3.10


The following packages will be downloaded:

    package                    |            build
    ---------------------------|-----------------
    ncurses-6.5                |       he02047a_1         868 KB  conda-forge
    openssl-3.3.1              |       hb9d3cd8_3         2.8 MB  conda-forge
    setuptools-72.2.0          |     pyhd8ed1ab_0         1.4 MB  conda-forge
    tzdata-2024a               |       h8827d51_1         121 KB  conda-forge
    ------------------------------------------------------------
                                           Total:         5.1 MB

The following NEW packages will be INSTALLED:

  _libgcc_mutex      conda-forge/linux-64::_libgcc_mutex-0.1-conda_forge 
  _openmp_mutex      conda-forge/linux-64::_openmp_mutex-4.5-2_gnu 
  bzip2              conda-forge/linux-64::bzip2-1.0.8-h4bc722e_7 
  ca-certificates    conda-forge/linux-64::ca-certificates-2024.7.4-hbcca054_0 
  ld_impl_linux-64   conda-forge/linux-64::ld_impl_linux-64-2.40-hf3520f5_7 
  libffi             conda-forge/linux-64::libffi-3.4.2-h7f98852_5 
  libgcc-ng          conda-forge/linux-64::libgcc-ng-14.1.0-h77fa898_0 
  libgomp            conda-forge/linux-64::libgomp-14.1.0-h77fa898_0 
  libnsl             conda-forge/linux-64::libnsl-2.0.1-hd590300_0 
  libsqlite          conda-forge/linux-64::libsqlite-3.46.0-hde9e2c9_0 
  libuuid            conda-forge/linux-64::libuuid-2.38.1-h0b41bf4_0 
  libxcrypt          conda-forge/linux-64::libxcrypt-4.4.36-hd590300_1 
  libzlib            conda-forge/linux-64::libzlib-1.3.1-h4ab18f5_1 
  ncurses            conda-forge/linux-64::ncurses-6.5-he02047a_1 
  openssl            conda-forge/linux-64::openssl-3.3.1-hb9d3cd8_3 
  pip                conda-forge/noarch::pip-24.2-pyhd8ed1ab_0 
  python             conda-forge/linux-64::python-3.10.14-hd12c33a_0_cpython 
  readline           conda-forge/linux-64::readline-8.2-h8228510_1 
  setuptools         conda-forge/noarch::setuptools-72.2.0-pyhd8ed1ab_0 
  tk                 conda-forge/linux-64::tk-8.6.13-noxft_h4845f30_101 
  tzdata             conda-forge/noarch::tzdata-2024a-h8827d51_1 
  wheel              conda-forge/noarch::wheel-0.44.0-pyhd8ed1ab_0 
  xz                 conda-forge/linux-64::xz-5.2.6-h166bdaf_0 


Preparing transaction: ...working... done
Verifying transaction: ...working... done
Executing transaction: ...working... done
+ /users/sparthib/.cache/R/basilisk/1.17.2/0/bin/conda install --yes --prefix /users/sparthib/.cache/R/basilisk/1.17.2/FLAMES/1.11.1/flames_env 'python=3.10' -c conda-forge -c bioconda -c defaults --override-channels
Channels:
 - conda-forge
 - bioconda
 - defaults
Platform: linux-64
Collecting package metadata (repodata.json): ...working... done
Solving environment: ...working... done


==> WARNING: A newer version of conda exists. <==
    current version: 24.3.0
    latest version: 24.7.1

Please update conda by running

    $ conda update -n base -c conda-forge conda



# All requested packages already installed.

+ /users/sparthib/.cache/R/basilisk/1.17.2/0/bin/conda install --yes --prefix /users/sparthib/.cache/R/basilisk/1.17.2/FLAMES/1.11.1/flames_env -c conda-forge -c bioconda -c defaults 'python=3.10' 'python=3.10' 'numpy=1.25.0' 'scipy=1.11.1' 'pysam=0.21.0' 'cutadapt=4.4' 'tqdm=4.64.1' 'pandas=1.3.5' --override-channels
Channels:
 - conda-forge
 - bioconda
 - defaults
Platform: linux-64
Collecting package metadata (repodata.json): ...working... done
Solving environment: ...working... done


==> WARNING: A newer version of conda exists. <==
    current version: 24.3.0
    latest version: 24.7.1

Please update conda by running

    $ conda update -n base -c conda-forge conda



## Package Plan ##

  environment location: /users/sparthib/.cache/R/basilisk/1.17.2/FLAMES/1.11.1/flames_env

  added / updated specs:
    - cutadapt=4.4
    - numpy=1.25.0
    - pandas=1.3.5
    - pysam=0.21.0
    - python[version='3.10.*,3.10.*']
    - scipy=1.11.1
    - tqdm=4.64.1


The following packages will be downloaded:

    package                    |            build
    ---------------------------|-----------------
    c-ares-1.33.1              |       heb4867d_0         179 KB  conda-forge
    cffi-1.17.0                |  py310h2fdcea3_0         237 KB  conda-forge
    dnaio-1.2.1                |  py310h7c593f9_2         140 KB  bioconda
    idna-3.8                   |     pyhd8ed1ab_0          48 KB  conda-forge
    python-isal-1.7.0          |  py310h5b4e0ec_0          60 KB  conda-forge
    python-zlib-ng-0.5.0       |  py310h6420a16_0          51 KB  conda-forge
    python_abi-3.10            |          5_cp310           6 KB  conda-forge
    ------------------------------------------------------------
                                           Total:         721 KB

The following NEW packages will be INSTALLED:

  brotli-python      conda-forge/linux-64::brotli-python-1.1.0-py310hc6cd4ac_1 
  c-ares             conda-forge/linux-64::c-ares-1.33.1-heb4867d_0 
  certifi            conda-forge/noarch::certifi-2024.7.4-pyhd8ed1ab_0 
  cffi               conda-forge/linux-64::cffi-1.17.0-py310h2fdcea3_0 
  charset-normalizer conda-forge/noarch::charset-normalizer-3.3.2-pyhd8ed1ab_0 
  colorama           conda-forge/noarch::colorama-0.4.6-pyhd8ed1ab_0 
  cutadapt           bioconda/linux-64::cutadapt-4.4-py310h4b81fae_1 
  dnaio              bioconda/linux-64::dnaio-1.2.1-py310h7c593f9_2 
  h2                 conda-forge/noarch::h2-4.1.0-pyhd8ed1ab_0 
  hpack              conda-forge/noarch::hpack-4.0.0-pyh9f0ad1d_0 
  hyperframe         conda-forge/noarch::hyperframe-6.0.1-pyhd8ed1ab_0 
  idna               conda-forge/noarch::idna-3.8-pyhd8ed1ab_0 
  isa-l              conda-forge/linux-64::isa-l-2.31.0-h4bc722e_2 
  keyutils           conda-forge/linux-64::keyutils-1.6.1-h166bdaf_0 
  krb5               conda-forge/linux-64::krb5-1.21.3-h659f571_0 
  libblas            conda-forge/linux-64::libblas-3.9.0-20_linux64_openblas 
  libcblas           conda-forge/linux-64::libcblas-3.9.0-20_linux64_openblas 
  libcurl            conda-forge/linux-64::libcurl-8.8.0-hca28451_1 
  libdeflate         conda-forge/linux-64::libdeflate-1.21-h4bc722e_0 
  libedit            conda-forge/linux-64::libedit-3.1.20191231-he28a2e2_2 
  libev              conda-forge/linux-64::libev-4.33-hd590300_2 
  libgfortran-ng     conda-forge/linux-64::libgfortran-ng-14.1.0-h69a702a_0 
  libgfortran5       conda-forge/linux-64::libgfortran5-14.1.0-hc5f4f2c_0 
  liblapack          conda-forge/linux-64::liblapack-3.9.0-20_linux64_openblas 
  libnghttp2         conda-forge/linux-64::libnghttp2-1.58.0-h47da74e_1 
  libopenblas        conda-forge/linux-64::libopenblas-0.3.25-pthreads_h413a1c8_0 
  libssh2            conda-forge/linux-64::libssh2-1.11.0-h0841786_0 
  libstdcxx-ng       conda-forge/linux-64::libstdcxx-ng-14.1.0-hc0a3c3a_0 
  numpy              conda-forge/linux-64::numpy-1.25.0-py310ha4c1d20_0 
  packaging          conda-forge/noarch::packaging-24.1-pyhd8ed1ab_0 
  pandas             conda-forge/linux-64::pandas-1.3.5-py310hb5077e9_0 
  pbzip2             conda-forge/linux-64::pbzip2-1.1.13-h1fcc475_2 
  pigz               conda-forge/linux-64::pigz-2.8-h2797004_0 
  platformdirs       conda-forge/noarch::platformdirs-4.2.2-pyhd8ed1ab_0 
  pooch              conda-forge/noarch::pooch-1.8.2-pyhd8ed1ab_0 
  pycparser          conda-forge/noarch::pycparser-2.22-pyhd8ed1ab_0 
  pysam              bioconda/linux-64::pysam-0.21.0-py310h41dec4a_1 
  pysocks            conda-forge/noarch::pysocks-1.7.1-pyha2e5f31_6 
  python-dateutil    conda-forge/noarch::python-dateutil-2.9.0-pyhd8ed1ab_0 
  python-isal        conda-forge/linux-64::python-isal-1.7.0-py310h5b4e0ec_0 
  python-zlib-ng     conda-forge/linux-64::python-zlib-ng-0.5.0-py310h6420a16_0 
  python_abi         conda-forge/linux-64::python_abi-3.10-5_cp310 
  pytz               conda-forge/noarch::pytz-2024.1-pyhd8ed1ab_0 
  requests           conda-forge/noarch::requests-2.32.3-pyhd8ed1ab_0 
  scipy              conda-forge/linux-64::scipy-1.11.1-py310ha4c1d20_0 
  six                conda-forge/noarch::six-1.16.0-pyh6c4a22f_0 
  tqdm               conda-forge/noarch::tqdm-4.64.1-pyhd8ed1ab_0 
  urllib3            conda-forge/noarch::urllib3-2.2.2-pyhd8ed1ab_1 
  xopen              conda-forge/noarch::xopen-2.0.2-pyh707e725_1 
  zlib               conda-forge/linux-64::zlib-1.2.13-h4ab18f5_6 
  zlib-ng            conda-forge/linux-64::zlib-ng-2.2.1-he02047a_0 
  zstandard          conda-forge/linux-64::zstandard-0.23.0-py310h64cae3c_0 
  zstd               conda-forge/linux-64::zstd-1.5.6-ha6fb4c9_0 

The following packages will be SUPERSEDED by a higher-priority channel:

  setuptools         conda-forge/noarch::setuptools-72.2.0~ --> conda-forge/linux-64::setuptools-59.8.0-py310hff52083_1 

The following packages will be DOWNGRADED:

  libzlib                                  1.3.1-h4ab18f5_1 --> 1.2.13-h4ab18f5_6 



Downloading and Extracting Packages: ...working... done
Preparing transaction: ...working... done
Verifying transaction: ...working... done
Executing transaction: ...working... done
Collecting fast-edit-distance==1.2.1
  Using cached fast_edit_distance-1.2.1-cp310-cp310-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (2.4 kB)
Collecting blaze2==2.2.*
  Using cached blaze2-2.2.1-py3-none-any.whl.metadata (12 kB)
Collecting matplotlib==3.5.3
  Using cached matplotlib-3.5.3-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (6.7 kB)
Collecting cython (from fast-edit-distance==1.2.1)
  Using cached Cython-3.0.11-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (3.2 kB)
Requirement already satisfied: tqdm in /users/sparthib/.cache/R/basilisk/1.17.2/FLAMES/1.11.1/flames_env/lib/python3.10/site-packages (from blaze2==2.2.*) (4.64.1)
Requirement already satisfied: numpy in /users/sparthib/.cache/R/basilisk/1.17.2/FLAMES/1.11.1/flames_env/lib/python3.10/site-packages (from blaze2==2.2.*) (1.25.0)
Requirement already satisfied: pandas in /users/sparthib/.cache/R/basilisk/1.17.2/FLAMES/1.11.1/flames_env/lib/python3.10/site-packages (from blaze2==2.2.*) (1.3.5)
Collecting cycler>=0.10 (from matplotlib==3.5.3)
  Using cached cycler-0.12.1-py3-none-any.whl.metadata (3.8 kB)
Collecting fonttools>=4.22.0 (from matplotlib==3.5.3)
  Using cached fonttools-4.53.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (162 kB)
Collecting kiwisolver>=1.0.1 (from matplotlib==3.5.3)
  Using cached kiwisolver-1.4.5-cp310-cp310-manylinux_2_12_x86_64.manylinux2010_x86_64.whl.metadata (6.4 kB)
Requirement already satisfied: packaging>=20.0 in /users/sparthib/.cache/R/basilisk/1.17.2/FLAMES/1.11.1/flames_env/lib/python3.10/site-packages (from matplotlib==3.5.3) (24.1)
Collecting pillow>=6.2.0 (from matplotlib==3.5.3)
  Using cached pillow-10.4.0-cp310-cp310-manylinux_2_28_x86_64.whl.metadata (9.2 kB)
Collecting pyparsing>=2.2.1 (from matplotlib==3.5.3)
  Downloading pyparsing-3.1.4-py3-none-any.whl.metadata (5.1 kB)
Requirement already satisfied: python-dateutil>=2.7 in /users/sparthib/.cache/R/basilisk/1.17.2/FLAMES/1.11.1/flames_env/lib/python3.10/site-packages (from matplotlib==3.5.3) (2.9.0)
Requirement already satisfied: six>=1.5 in /users/sparthib/.cache/R/basilisk/1.17.2/FLAMES/1.11.1/flames_env/lib/python3.10/site-packages (from python-dateutil>=2.7->matplotlib==3.5.3) (1.16.0)
Requirement already satisfied: pytz>=2017.3 in /users/sparthib/.cache/R/basilisk/1.17.2/FLAMES/1.11.1/flames_env/lib/python3.10/site-packages (from pandas->blaze2==2.2.*) (2024.1)
Using cached fast_edit_distance-1.2.1-cp310-cp310-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl (115 kB)
Using cached blaze2-2.2.1-py3-none-any.whl (17.4 MB)
Using cached matplotlib-3.5.3-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (11.9 MB)
Using cached cycler-0.12.1-py3-none-any.whl (8.3 kB)
Using cached fonttools-4.53.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (4.6 MB)
Using cached kiwisolver-1.4.5-cp310-cp310-manylinux_2_12_x86_64.manylinux2010_x86_64.whl (1.6 MB)
Using cached pillow-10.4.0-cp310-cp310-manylinux_2_28_x86_64.whl (4.5 MB)
Downloading pyparsing-3.1.4-py3-none-any.whl (104 kB)
Using cached Cython-3.0.11-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (3.6 MB)
Installing collected packages: pyparsing, pillow, kiwisolver, fonttools, cython, cycler, matplotlib, fast-edit-distance, blaze2
Successfully installed blaze2-2.2.1 cycler-0.12.1 cython-3.0.11 fast-edit-distance-1.2.1 fonttools-4.53.1 kiwisolver-1.4.5 matplotlib-3.5.3 pillow-10.4.0 pyparsing-3.1.4
[E::idx_find_and_load] Could not retrieve index file for '/dcs04/hicks/data/sparthib/retina_single_cell_lrs/05_flames_output//10x_D100-EP1_A1/align2genome.bam'
[E::idx_find_and_load] Could not retrieve index file for '/dcs04/hicks/data/sparthib/retina_single_cell_lrs/05_flames_output//10x_D100-EP1_A1/align2genome.bam'
Error in value[[3L]](cond) : Error when quantifying genes:
Traceback (most recent call last):
  File "/jhpce/shared/community/core/conda_R/4.4.x/R/lib64/R/site-library/FLAMES/python/count_gene.py", line 485, in quantification
    quantify_gene(in_bam, annotation, n_process)
  File "/jhpce/shared/community/core/conda_R/4.4.x/R/lib64/R/site-library/FLAMES/python/count_gene.py", line 198, in quantify_gene
    [x for x in independent_gene_set_generator(in_gtf_df, in_bam, threads=n_process)]
  File "/jhpce/shared/community/core/conda_R/4.4.x/R/lib64/R/site-library/FLAMES/python/count_gene.py", line 198, in <listcomp>
    [x for x in independent_gene_set_generator(in_gtf_df, in_bam, threads=n_process)]
  File "/jhpce/shared/community/core/conda_R/4.4.x/R/lib64/R/site-library/FLAMES/python/count_gene.py", line 606, in independent_gene_set_generator
    yield from _yield_genes_per_chr(gtf_df[gtf_df.chr_name==chr], bam)
  File "/jhpce/shared/community/core/conda_R/4.4.x/R/lib64/R/site-library/FLAMES/python/count_g
Calls: sc_long_pipeline ... tryCatch -> tryCatchList -> tryCatchOne -> <Anonymous>
Execution halted
**** Job ends ****
2024-08-27 11:53:11
