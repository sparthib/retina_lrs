**** Job starts ****
2024-09-21 19:29:37
**** JHPCE info ****
User: sparthib
Job id: 9812232
Job name: flames
Node name: compute-100
Array task ID: 8
10x_D200-EP1-1_B2
Loading conda_R/4.4.x
Registered S3 method overwritten by 'GGally':
  method from   
  +.gg   ggplot2
07:30:06 PM Sat Sep 21 2024 Start running
Skipping Demultiplexing step...
Please make sure the ` /dcs04/hicks/data/sparthib/retina_single_cell_lrs/05b_flames_output_min_cnt_1/10x_D200-EP1-1_B2/matched_reads.fastq `` is the demultiplexing output from previous FLAMES call.
Running FLAMES pipeline...
#### Input parameters:
{
  "pipeline_parameters": {
    "seed": [2022],
    "threads": [20],
    "do_barcode_demultiplex": [false],
    "do_gene_quantification": [false],
    "do_genome_alignment": [true],
    "do_isoform_identification": [true],
    "bambu_isoform_identification": [true],
    "multithread_isoform_identification": [false],
    "do_read_realignment": [true],
    "do_transcript_quantification": [true]
  },
  "barcode_parameters": {
    "max_bc_editdistance": [2],
    "max_flank_editdistance": [8],
    "pattern": {
      "primer": ["CTACACGACGCTCTTCCGATCT"],
      "BC": ["NNNNNNNNNNNNNNNN"],
      "UMI": ["NNNNNNNNNNNN"],
      "polyT": ["TTTTTTTTT"]
    },
    "TSO_seq": ["CCCATGTACTCTGCGTTGATACCACTGCTT"],
    "TSO_prime": [3],
    "full_length_only": [false]
  },
  "isoform_parameters": {
    "generate_raw_isoform": [false],
    "max_dist": [10],
    "max_ts_dist": [100],
    "max_splice_match_dist": [10],
    "min_fl_exon_len": [40],
    "max_site_per_splice": [3],
    "min_sup_cnt": [2],
    "min_cnt_pct": [0.001],
    "min_sup_pct": [0.2],
    "bambu_trust_reference": [true],
    "strand_specific": [0],
    "remove_incomp_reads": [4],
    "downsample_ratio": [1]
  },
  "alignment_parameters": {
    "use_junctions": [true],
    "no_flank": [false]
  },
  "realign_parameters": {
    "use_annotation": [true]
  },
  "transcript_counting": {
    "min_tr_coverage": [0.4],
    "min_read_coverage": [0.4]
  }
} 
gene annotation: /dcs04/hicks/data/sparthib/references/genome/GENCODE/gencode.v44.chr_patch_hapl_scaff.annotation.gtf 
genome fasta: /dcs04/hicks/data/sparthib/references/genome/GENCODE/GRCh38.p14.genome.fa 
input fastq: /dcs04/hicks/data/sparthib/retina_single_cell_lrs/05b_flames_output_min_cnt_1/10x_D200-EP1-1_B2/matched_reads.fastq 
output directory: /dcs04/hicks/data/sparthib/retina_single_cell_lrs/05b_flames_output_min_cnt_1/10x_D200-EP1-1_B2 
minimap2 path: 
k8 path: 
#### Aligning reads to genome using minimap2
07:30:06 PM Sat Sep 21 2024 minimap2_align
[M::mm_idx_gen::100.301*2.01] collected minimizers
[M::mm_idx_gen::111.407*3.46] sorted minimizers
[M::main::111.407*3.46] loaded/built the index for 706 target sequence(s)
[M::mm_mapopt_update::113.704*3.41] mid_occ = 2173
[M::mm_idx_stat] kmer size: 14; skip: 5; is_hpc: 0; #seq: 706
[M::mm_idx_stat::115.412*3.37] distinct minimizers: 65649907 (22.01% are singletons); average occurrences: 16.223; average spacing: 3.091; total length: 3291585349
[M::worker_pipeline::712.223*16.88] mapped 507341 sequences
[M::worker_pipeline::1288.598*18.22] mapped 501319 sequences
[M::worker_pipeline::1861.752*18.74] mapped 497766 sequences
[M::worker_pipeline::2468.345*19.01] mapped 491392 sequences
[M::worker_pipeline::2650.602*19.04] mapped 143981 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: /users/sparthib/minimap2/minimap2 -ax splice -t 20 -k14 --secondary=no --seed 2022 --junc-bed /dcs04/hicks/data/sparthib/retina_single_cell_lrs/05b_flames_output_min_cnt_1/10x_D200-EP1-1_B2/tmp_splice_anno.bed12 --junc-bonus 1 /dcs04/hicks/data/sparthib/references/genome/GENCODE/GRCh38.p14.genome.fa /dcs04/hicks/data/sparthib/retina_single_cell_lrs/05b_flames_output_min_cnt_1/10x_D200-EP1-1_B2/matched_reads.fastq
[M::main] Real time: 2650.995 sec; CPU: 50474.625 sec; Peak RSS: 29.898 GB
[bam_sort_core] merging from 5 files and 1 in-memory blocks...
#### Skip gene quantification and UMI deduplication
08:19:30 PM Sat Sep 21 2024 Start isoform identificaiton
08:19:30 PM Sat Sep 21 2024 find_isoform
--- Start generating read class files ---
'getOption("repos")' replaces Bioconductor standard repositories, see
'help("repositories", package = "BiocManager")' for details.
Replacement repositories:
    CRAN: https://cran.rstudio.com
[20:26:42] WARNING: src/learner.cc:553: 
  If you are loading a serialized model (like pickle in Python, RDS in R) generated by
  older XGBoost, please export the model by calling `Booster.save_model` from that version
  first, then load it back in current version. See:

    https://xgboost.readthedocs.io/en/latest/tutorials/saving_model.html

  for more details about differences between saving model and serializing.

[20:26:42] WARNING: src/learner.cc:553: 
  If you are loading a serialized model (like pickle in Python, RDS in R) generated by
  older XGBoost, please export the model by calling `Booster.save_model` from that version
  first, then load it back in current version. See:

    https://xgboost.readthedocs.io/en/latest/tutorials/saving_model.html

  for more details about differences between saving model and serializing.

[20:26:43] WARNING: src/learner.cc:553: 
  If you are loading a serialized model (like pickle in Python, RDS in R) generated by
  older XGBoost, please export the model by calling `Booster.save_model` from that version
  first, then load it back in current version. See:

    https://xgboost.readthedocs.io/en/latest/tutorials/saving_model.html

  for more details about differences between saving model and serializing.

[20:26:43] WARNING: src/learner.cc:553: 
  If you are loading a serialized model (like pickle in Python, RDS in R) generated by
  older XGBoost, please export the model by calling `Booster.save_model` from that version
  first, then load it back in current version. See:

    https://xgboost.readthedocs.io/en/latest/tutorials/saving_model.html

  for more details about differences between saving model and serializing.

[20:51:07] WARNING: src/learner.cc:553: 
  If you are loading a serialized model (like pickle in Python, RDS in R) generated by
  older XGBoost, please export the model by calling `Booster.save_model` from that version
  first, then load it back in current version. See:

    https://xgboost.readthedocs.io/en/latest/tutorials/saving_model.html

  for more details about differences between saving model and serializing.

[20:51:07] WARNING: src/learner.cc:553: 
  If you are loading a serialized model (like pickle in Python, RDS in R) generated by
  older XGBoost, please export the model by calling `Booster.save_model` from that version
  first, then load it back in current version. See:

    https://xgboost.readthedocs.io/en/latest/tutorials/saving_model.html

  for more details about differences between saving model and serializing.

Detected 2 warnings across the samples during read class construction. Access warnings with metadata(bambuOutput)$warnings
--- Start extending annotations ---
Using a novel discovery rate (NDR) of: 0.09
--- Start isoform quantification ---
--- Finished running Bambu ---
Import genomic features from the file as a GRanges object ... OK
Prepare the 'metadata' data frame ... OK
Make the TxDb object ... OK
09:01:31 PM Sat Sep 21 2024 Isoform identificaiton done
#### Realigning deduplicated reads to transcript using minimap2
09:01:31 PM Sat Sep 21 2024 minimap2_realign
[M::mm_idx_gen::5.080*1.44] collected minimizers
[M::mm_idx_gen::5.393*2.22] sorted minimizers
[M::main::5.421*2.21] loaded/built the index for 50677 target sequence(s)
[M::mm_mapopt_update::5.824*2.13] mid_occ = 66
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 50677
[M::mm_idx_stat::6.081*2.08] distinct minimizers: 12730501 (55.72% are singletons); average occurrences: 2.087; average spacing: 5.369; total length: 142632921
[M::worker_pipeline::60.783*17.20] mapped 507341 sequences
[M::worker_pipeline::102.699*18.37] mapped 501319 sequences
[M::worker_pipeline::142.190*18.88] mapped 497766 sequences
[M::worker_pipeline::180.963*19.13] mapped 491392 sequences
[M::worker_pipeline::186.040*18.80] mapped 143981 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: /users/sparthib/minimap2/minimap2 -ax map-ont -p 0.9 --end-bonus 10 -N 3 -t 20 --seed 2022 /dcs04/hicks/data/sparthib/retina_single_cell_lrs/05b_flames_output_min_cnt_1/10x_D200-EP1-1_B2/transcript_assembly.fa /dcs04/hicks/data/sparthib/retina_single_cell_lrs/05b_flames_output_min_cnt_1/10x_D200-EP1-1_B2/matched_reads.fastq
[M::main] Real time: 186.256 sec; CPU: 3497.448 sec; Peak RSS: 3.940 GB
[bam_sort_core] merging from 5 files and 1 in-memory blocks...
#### Generating transcript count matrix
09:09:28 PM Sat Sep 21 2024 quantify transcripts 
Found realignment file(s): 	realign2transcript.bam
	Counter({'unmapped': 804302, 'counted_reads': 626320, 'no_good_match': 607203, 'not_enough_coverage': 103974})
shared splice chain: {'ENSG00000275724.1', 'ENSG00000274359.1', 'ENSG00000276220.1', 'ENSG00000276766.1', 'ENSG00000273642.1', 'ENSG00000275605.1', 'ENSG00000278365.1'}
(77309, 77534, 77609, 80353, 80431, 81230)
shared splice chain: {'ENSG00000276628.1', 'ENSG00000276774.1', 'ENSG00000278516.1'}
(130791, 131613, 131876, 133132, 133312, 134414)
shared splice chain: {'ENSG00000277359.3', 'ENSG00000274005.3', 'ENSG00000277079.3', 'ENSG00000278270.4', 'ENSG00000275323.3', 'ENSG00000278081.3', 'ENSG00000274626.3'}
(175870, 176141, 176263, 176468, 176591, 181257, 181444, 182379)
shared splice chain: {'ENSG00000277365.3', 'ENSG00000273397.4'}
(8659, 9404, 9520, 12950)
Error in .local(x, ...) : strand values must be in '+' '-' '*'
Calls: sc_long_pipeline ... new_GRanges -> normarg_strand -> strand -> strand -> .local
In addition: There were 50 or more warnings (use warnings() to see the first 50)
Execution halted
**** Job ends ****
2024-09-21 21:17:07
