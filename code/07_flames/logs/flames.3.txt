**** Job starts ****
2023-12-05 23:48:10
**** JHPCE info ****
User: sparthib
Job id: 1003867
Job name: flames
Node name: compute-145
Task id: 3
Loading LIBD SLURM module for samtools/1.18
hRGC
Preprocessing bulk fastqs...
hRGC.fastq.gz GGVNQTORYFGAXXTF
hRGC.fastq.gz 34951719
Running FLAMES pipeline...
Use config file: /users/sparthib/retina_lrs/code/07_flames/config.json
Parameters in configuration file:
comment : custom bulk config. use splice annotation on alignment.
pipeline_parameters
	 do_genome_alignment : True
	 do_isoform_identification : True
	 do_read_realignment : True
	 do_transcript_quantification : True
global_parameters
	 generate_raw_isoform : True
	 has_UMI : False
isoform_parameters
	 MAX_DIST : 10
	 MAX_TS_DIST : 100
	 MAX_SPLICE_MATCH_DIST : 10
	 min_fl_exon_len : 40
	 Max_site_per_splice : 3
	 Min_sup_cnt : 10
	 Min_cnt_pct : 0.01
	 Min_sup_pct : 0.2
	 strand_specific : 0
	 remove_incomp_reads : 5
alignment_parameters
	 use_junctions : True
	 no_flank : True
	 seed : 2022
realign_parameters
	 use_annotation : True
transcript_counting
	 min_tr_coverage : 0.4
	 min_read_coverage : 0.4
Input parameters:
	gene annotation: /dcs04/hicks/data/sparthib/ENSEMBL_GTF.gtf.gz
	genome fasta: /dcs04/hicks/data/sparthib/ENSEMBL_DNA_PRIMARY.fa.gz
	input fastq: /dcs04/hicks/data/sparthib/casey/flames_output/hRGC/merged.fastq.gz
	output directory: /dcs04/hicks/data/sparthib/casey/flames_output/hRGC
	directory contains minimap2: 
### align reads to genome using minimap2 2023-12-06 09:10:12
b''
b'[M::mm_idx_gen::47.155*1.82] collected minimizers\n[M::mm_idx_gen::56.102*3.40] sorted minimizers\n[M::main::56.102*3.40] loaded/built the index for 194 target sequence(s)\n[M::mm_mapopt_update::57.345*3.35] mid_occ = 2053\n[M::mm_idx_stat] kmer size: 14; skip: 5; is_hpc: 0; #seq: 194\n[M::mm_idx_stat::58.130*3.32] distinct minimizers: 65621209 (23.06% are singletons); average occurrences: 15.289; average spacing: 3.090; total length: 3099750718\n[M::worker_pipeline::926.102*11.34] mapped 249497 sequences\n[M::worker_pipeline::1768.803*11.64] mapped 248548 sequences\n[M::worker_pipeline::2605.042*11.74] mapped 247355 sequences\n[M::worker_pipeline::3443.026*11.80] mapped 247331 sequences\n[M::worker_pipeline::4264.332*11.83] mapped 246671 sequences\n[M::worker_pipeline::5065.791*11.85] mapped 250743 sequences\n[M::worker_pipeline::5882.957*11.87] mapped 247924 sequences\n[M::worker_pipeline::6707.049*11.88] mapped 247092 sequences\n[M::worker_pipeline::7510.462*11.89] mapped 247205 sequences\n[M::worker_pipeline::8305.226*11.90] mapped 246897 sequences\n[M::worker_pipeline::9116.060*11.90] mapped 246379 sequences\n[M::worker_pipeline::9914.209*11.91] mapped 246628 sequences\n[M::worker_pipeline::10734.612*11.91] mapped 249023 sequences\n[M::worker_pipeline::11554.155*11.92] mapped 245947 sequences\n[M::worker_pipeline::12392.751*11.92] mapped 245540 sequences\n[M::worker_pipeline::13295.375*11.92] mapped 247242 sequences\n[M::worker_pipeline::14211.082*11.91] mapped 246271 sequences\n[M::worker_pipeline::15062.399*11.92] mapped 246441 sequences\n[M::worker_pipeline::15883.133*11.92] mapped 245218 sequences\n[M::worker_pipeline::16685.926*11.92] mapped 247951 sequences\n[M::worker_pipeline::17495.256*11.92] mapped 245547 sequences\n[M::worker_pipeline::18324.319*11.93] mapped 245614 sequences\n[M::worker_pipeline::19161.618*11.93] mapped 245326 sequences\n[M::worker_pipeline::19992.114*11.93] mapped 245629 sequences\n[M::worker_pipeline::20815.536*11.93] mapped 244781 sequences\n[M::worker_pipeline::21645.966*11.93] mapped 244840 sequences\n[M::worker_pipeline::22471.999*11.93] mapped 246771 sequences\n[M::worker_pipeline::23291.992*11.94] mapped 245631 sequences\n[M::worker_pipeline::24122.241*11.94] mapped 245637 sequences\n[M::worker_pipeline::24939.531*11.94] mapped 245463 sequences\n[M::worker_pipeline::25786.936*11.94] mapped 245674 sequences\n[M::worker_pipeline::26578.940*11.94] mapped 245097 sequences\n[M::worker_pipeline::27417.614*11.94] mapped 244844 sequences\n[M::worker_pipeline::28232.731*11.94] mapped 246181 sequences\n[M::worker_pipeline::29071.896*11.94] mapped 245343 sequences\n[M::worker_pipeline::29892.513*11.94] mapped 244753 sequences\n[M::worker_pipeline::30699.193*11.94] mapped 245860 sequences\n[M::worker_pipeline::31522.157*11.94] mapped 244614 sequences\n[M::worker_pipeline::32333.627*11.94] mapped 244987 sequences\n[M::worker_pipeline::33136.267*11.94] mapped 247157 sequences\n[M::worker_pipeline::33971.837*11.94] mapped 244572 sequences\n[M::worker_pipeline::34785.459*11.94] mapped 244563 sequences\n[M::worker_pipeline::35603.040*11.94] mapped 244370 sequences\n[M::worker_pipeline::36418.477*11.95] mapped 244527 sequences\n[M::worker_pipeline::37247.329*11.95] mapped 244721 sequences\n[M::worker_pipeline::38030.080*11.95] mapped 247277 sequences\n[M::worker_pipeline::38872.021*11.95] mapped 244932 sequences\n[M::worker_pipeline::39683.407*11.95] mapped 244639 sequences\n[M::worker_pipeline::40493.926*11.95] mapped 244226 sequences\n[M::worker_pipeline::41312.179*11.95] mapped 244705 sequences\n[M::worker_pipeline::42105.977*11.95] mapped 243866 sequences\n[M::worker_pipeline::42940.780*11.95] mapped 245190 sequences\n[M::worker_pipeline::43786.635*11.95] mapped 244327 sequences\n[M::worker_pipeline::44632.644*11.95] mapped 243644 sequences\n[M::worker_pipeline::45501.095*11.95] mapped 245743 sequences\n[M::worker_pipeline::46338.472*11.95] mapped 244062 sequences\n[M::worker_pipeline::47195.044*11.95] mapped 243990 sequences\n[M::worker_pipeline::48071.010*11.95] mapped 245895 sequences\n[M::worker_pipeline::48906.985*11.95] mapped 243353 sequences\n[M::worker_pipeline::49740.824*11.95] mapped 246025 sequences\n[M::worker_pipeline::50584.032*11.95] mapped 244858 sequences\n[M::worker_pipeline::51418.011*11.95] mapped 242373 sequences\n[M::worker_pipeline::52270.187*11.95] mapped 245288 sequences\n[M::worker_pipeline::53113.451*11.95] mapped 243758 sequences\n[M::worker_pipeline::53923.960*11.95] mapped 243235 sequences\n[M::worker_pipeline::54728.525*11.95] mapped 243756 sequences\n[M::worker_pipeline::55564.039*11.95] mapped 243921 sequences\n[M::worker_pipeline::56420.327*11.95] mapped 242585 sequences\n[M::worker_pipeline::57223.918*11.95] mapped 245101 sequences\n[M::worker_pipeline::58007.713*11.95] mapped 243203 sequences\n[M::worker_pipeline::58873.000*11.95] mapped 242945 sequences\n[M::worker_pipeline::59679.757*11.95] mapped 243331 sequences\n[M::worker_pipeline::60530.303*11.95] mapped 245601 sequences\n[M::worker_pipeline::61297.132*11.95] mapped 243157 sequences\n[M::worker_pipeline::62138.676*11.95] mapped 244055 sequences\n[M::worker_pipeline::62926.091*11.95] mapped 243338 sequences\n[M::worker_pipeline::63744.649*11.95] mapped 243346 sequences\n[M::worker_pipeline::64533.381*11.95] mapped 245210 sequences\n[M::worker_pipeline::65379.696*11.95] mapped 242750 sequences\n[M::worker_pipeline::66187.146*11.95] mapped 242319 sequences\n[M::worker_pipeline::66972.717*11.95] mapped 242234 sequences\n[M::worker_pipeline::67819.476*11.95] mapped 243129 sequences\n[M::worker_pipeline::68629.430*11.95] mapped 245061 sequences\n[M::worker_pipeline::69484.110*11.95] mapped 244553 sequences\n[M::worker_pipeline::70242.535*11.95] mapped 242463 sequences\n[M::worker_pipeline::71067.739*11.95] mapped 242729 sequences\n[M::worker_pipeline::71880.664*11.95] mapped 244957 sequences\n[M::worker_pipeline::72680.559*11.95] mapped 242126 sequences\n[M::worker_pipeline::73475.696*11.95] mapped 243080 sequences\n[M::worker_pipeline::74296.038*11.95] mapped 242221 sequences\n[M::worker_pipeline::75104.919*11.95] mapped 241750 sequences\n[M::worker_pipeline::75915.153*11.95] mapped 245816 sequences\n[M::worker_pipeline::76724.461*11.95] mapped 242247 sequences\n[M::worker_pipeline::77538.367*11.95] mapped 242662 sequences\n[M::worker_pipeline::78350.103*11.95] mapped 242598 sequences\n[M::worker_pipeline::79156.275*11.95] mapped 245867 sequences\n[M::worker_pipeline::79977.064*11.95] mapped 242939 sequences\n[M::worker_pipeline::80801.265*11.95] mapped 242390 sequences\n[M::worker_pipeline::81600.249*11.95] mapped 242317 sequences\n[M::worker_pipeline::82415.768*11.95] mapped 248287 sequences\n[M::worker_pipeline::83259.585*11.95] mapped 244744 sequences\n[M::worker_pipeline::84024.550*11.95] mapped 244483 sequences\n[M::worker_pipeline::84855.120*11.95] mapped 243253 sequences\n[M::worker_pipeline::85660.430*11.95] mapped 245670 sequences\n[M::worker_pipeline::86455.331*11.95] mapped 243308 sequences\n[M::worker_pipeline::87283.397*11.95] mapped 241996 sequences\n[M::worker_pipeline::88072.230*11.95] mapped 245544 sequences\n[M::worker_pipeline::88878.833*11.95] mapped 244711 sequences\n[M::worker_pipeline::89688.339*11.95] mapped 244925 sequences\n[M::worker_pipeline::90496.213*11.95] mapped 245995 sequences\n[M::worker_pipeline::91280.177*11.95] mapped 246223 sequences\n[M::worker_pipeline::92100.024*11.95] mapped 244699 sequences\n[M::worker_pipeline::92919.853*11.95] mapped 244268 sequences\n[M::worker_pipeline::93733.658*11.95] mapped 247473 sequences\n[M::worker_pipeline::94552.381*11.95] mapped 245330 sequences\n[M::worker_pipeline::95363.843*11.95] mapped 242537 sequences\n[M::worker_pipeline::96138.706*11.95] mapped 248774 sequences\n[M::worker_pipeline::96983.162*11.95] mapped 245778 sequences\n[M::worker_pipeline::97775.500*11.95] mapped 243744 sequences\n[M::worker_pipeline::98609.035*11.95] mapped 249997 sequences\n[M::worker_pipeline::99409.114*11.95] mapped 245300 sequences\n[M::worker_pipeline::100192.696*11.95] mapped 246313 sequences\n[M::worker_pipeline::100985.537*11.95] mapped 246883 sequences\n[M::worker_pipeline::101794.626*11.95] mapped 244751 sequences\n[M::worker_pipeline::102609.714*11.95] mapped 249952 sequences\n[M::worker_pipeline::103421.830*11.95] mapped 247970 sequences\n[M::worker_pipeline::104274.838*11.95] mapped 245097 sequences\n[M::worker_pipeline::105038.369*11.95] mapped 248641 sequences\n[M::worker_pipeline::105898.453*11.95] mapped 243873 sequences\n[M::worker_pipeline::106686.295*11.95] mapped 254104 sequences\n[M::worker_pipeline::107514.750*11.95] mapped 247265 sequences\n[M::worker_pipeline::108314.282*11.95] mapped 251969 sequences\n[M::worker_pipeline::109138.004*11.95] mapped 245332 sequences\n[M::worker_pipeline::109987.456*11.95] mapped 247122 sequences\n[M::worker_pipeline::110838.896*11.95] mapped 245731 sequences\n[M::worker_pipeline::111732.515*11.95] mapped 246172 sequences\n[M::worker_pipeline::112587.561*11.95] mapped 244789 sequences\n[M::worker_pipeline::113538.172*11.95] mapped 234428 sequences\n[M::worker_pipeline::114403.728*11.95] mapped 240334 sequences\n[M::worker_pipeline::115311.316*11.95] mapped 243398 sequences\n[M::worker_pipeline::116134.287*11.95] mapped 249922 sequences\n[M::worker_pipeline::116988.386*11.95] mapped 249033 sequences\n[M::worker_pipeline::117375.258*11.95] mapped 136053 sequences\n[M::main] Version: 2.26-r1175\n[M::main] CMD: minimap2 -ax splice -t 12 --junc-bed /dcs04/hicks/data/sparthib/casey/flames_output/hRGC/tmp.splice_anno.bed12 --junc-bonus 1 --splice-flank=no -k14 --secondary=no /dcs04/hicks/data/sparthib/ENSEMBL_DNA_PRIMARY.fa.gz /dcs04/hicks/data/sparthib/casey/flames_output/hRGC/merged.fastq.gz\n[M::main] Real time: 117375.391 sec; CPU: 1402657.431 sec; Peak RSS: 24.817 GB\n'
b'[bam_sort_core] merging from 15 files and 12 in-memory blocks...\n'
b''
### read gene annotation 2023-12-07 20:24:22
remove similar transcripts in gene annotation: Counter({'duplicated_transcripts': 765})
### find isoforms 2023-12-07 20:26:38
Traceback (most recent call last):
  File "/users/sparthib/flames/python/bulk_long_pipeline.py", line 270, in <module>
    bulk_long_pipeline(args)
  File "/users/sparthib/flames/python/bulk_long_pipeline.py", line 202, in bulk_long_pipeline
    group_bam2isoform(genome_bam, isoform_gff3, tss_tes_stat, "", chr_to_blocks, gene_dict, transcript_to_junctions, transcript_dict, args.genomefa,
  File "/users/sparthib/flames/python/sc_longread.py", line 1115, in group_bam2isoform
    for c in get_fa(fa_f):
  File "/users/sparthib/flames/python/sc_longread.py", line 45, in get_fa
    for line in open(fn):
  File "/users/sparthib/.conda/envs/FLAMES/lib/python3.10/codecs.py", line 322, in decode
    (result, consumed) = self._buffer_decode(data, self.errors, final)
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
**** Job ends ****
2023-12-07 20:26:45
