H9_FT2_genome_decile_1 <- c(0.0,0.2885221755009905,0.4642493443057663,0.5221799577057721,0.5757363050710734,0.6196360646312848,0.6391018827393646,0.6678465820336438,0.6943294983298459,0.7533308375727837,0.7702006190377506,0.7370226022314773,0.6905256918493363,0.6906081410817785,0.6355342821680137,0.629239171853169,0.6067750985491164,0.5859845218278772,0.5729430587773893,0.5405761641497367,0.5292427372253827,0.5372614821697964,0.5034383558286036,0.4833162863974365,0.5152330527831073,0.49188432149852596,0.45838207865656777,0.4387034523944817,0.4448871448276477,0.4372093386011708,0.4468068749289711,0.42441410906919275,0.42123201436845004,0.38922945621388666,0.4131285918339606,0.43218327795864614,0.407412854503845,0.4400293251864578,0.42750372692814215,0.41534023678528215,0.42745470306020356,0.4083465363523123,0.42672937265047545,0.43403838568859593,0.4092958167042145,0.3976493055323435,0.4483856663123578,0.4088601727868509,0.43277713526799344,0.4347826571382094,0.45012824198181217,0.4063209592633941,0.43969284318378826,0.43690516778418803,0.4180811166745773,0.4130238590251827,0.4251684081281573,0.4129915478394959,0.4325643271139872,0.40552097887294125,0.42291553856061465,0.45749742067603916,0.5062661416656082,0.5044433451213453,0.5109222949409596,0.5159895801997054,0.5156408422300511,0.5298332519982797,0.561711022125363,0.5685097412653952,0.5806542903683698,0.5773050688451091,0.5842898558475447,0.6166701206209987,0.6319577681661285,0.636540385639572,0.6699178404540501,0.6393770849071109,0.668226517010168,0.6520441838751585,0.6814774456782118,0.6938325745775591,0.7253549216620874,0.7231711311811855,0.7474680286388523,0.7923438088425687,0.8199966128963969,0.8011881602902213,0.8294871880577858,0.8405955508611488,0.8451458571489056,0.854914977014491,0.8716443719485427,0.8992069275182113,0.9307393022120907,0.9633780564710391,0.9687049453940962,1.0,0.9467834771738186,0.6271389447835262)
H9_FT2_genome_decile_2 <- c(0.0,0.1514184465791964,0.27571472371078787,0.35367198951253026,0.45155707756510616,0.4951703246165239,0.5326913459021353,0.578309190898229,0.6016615346378839,0.6300233360461954,0.6374336257044868,0.6278404837111138,0.6267750317547464,0.6457137967879577,0.6549504300005194,0.65144136500082,0.6305672665860618,0.6470563069968414,0.6606555890900164,0.6394422980352292,0.626333979463057,0.6120359401594918,0.6468057322537568,0.6215160179395218,0.6185519020762053,0.6392457089075246,0.6435940974369055,0.6310898065990794,0.6466071059330192,0.6380345976492829,0.6303757704409403,0.6205636301964974,0.5981463580590847,0.622756668496745,0.6036427048626779,0.6130036068502653,0.6199911789541662,0.6363783597132855,0.6542730633169781,0.6443977700885059,0.6571658774241323,0.6537933043576578,0.6401400366491027,0.6378084692225969,0.639656203303716,0.632717523832612,0.641082238426961,0.6360951898816697,0.6347231403738045,0.6417005265125394,0.660376493644467,0.6259764520857292,0.6431876774267807,0.6605557666313893,0.6551246100048587,0.6802238467704889,0.6791858969200697,0.6457341687182898,0.664622003925671,0.6444802764063507,0.656508882670923,0.6541284226116204,0.6673559169762351,0.6832236135118865,0.6860634606001774,0.7048616593140975,0.7086294478290143,0.719482593713426,0.7239460836491831,0.709319037670755,0.7210695670862944,0.716391153285534,0.7478993993336341,0.7589022789059866,0.7873201031227114,0.7981437097081415,0.8324103151232043,0.8402178574229712,0.8527771524726939,0.8588286343778362,0.8875846326380733,0.8988645704629419,0.9144032603237303,0.9233210728265951,0.9447309530090869,0.9192517797427636,0.8987749339694808,0.9144827108520255,0.9137370982018715,0.9339379043191548,0.9302852172106142,0.9482023299376721,0.954339373950209,0.9894076148238389,0.9699177890751449,0.9869487228327577,1.0,0.9824159683338715,0.9435065999961293,0.6674119397846483)
H9_FT2_genome_decile_4 <- c(0.0,0.13457794685936478,0.202734387730074,0.26741924362670855,0.3112651560240747,0.34289191261348256,0.37702544857028675,0.412415375828232,0.43058459501319857,0.44343580569415403,0.4570631488853708,0.4709452007567506,0.4897078825904473,0.5044878468797758,0.5208946878232099,0.5308017405950749,0.527987938643509,0.530297468864651,0.5369567715631909,0.5408374341144971,0.5407731137407186,0.5483740667113765,0.5505609594198474,0.5705886086045223,0.5686564245762145,0.5673974604601222,0.5683373955222728,0.5733964073212022,0.5675672662468976,0.5771055488757656,0.5891523260819973,0.5812640754417953,0.5888727468573065,0.5792478461250834,0.5780840761621834,0.580211794126778,0.5800016809057681,0.5794571017411096,0.5891188794876325,0.5747342710957962,0.5791586552067771,0.5881823748454167,0.5875889121966865,0.5917019856985793,0.610092466969344,0.6029957857291101,0.6085470627886913,0.6241794864318315,0.6334150345014485,0.6290635468140833,0.6325582871227181,0.6253964279037219,0.6286570420518027,0.6306243878844429,0.6250139360809853,0.6314614103485479,0.6436436891422064,0.6458288666407098,0.6441162294882328,0.6463940283249774,0.6579245273310133,0.6565600778019242,0.6602383455770738,0.6694009972230751,0.6867554916735132,0.6909894874781096,0.6968143405274957,0.714914951313765,0.7293295758800313,0.7324915654549852,0.7308346726264495,0.734717907992707,0.7559084695352981,0.7606553131201556,0.7689080458784362,0.7769944032698762,0.782631440827829,0.7816554863563623,0.7923849823076092,0.804047552481137,0.8089530529879815,0.818933859788446,0.8225786809692308,0.8393800202051734,0.8649435095597228,0.8727571485663418,0.8878312713650841,0.8919983739809508,0.8951963829652206,0.9035614619763679,0.9243926870307829,0.9406288645824579,0.9435635888367274,0.9633185196365813,0.9787554093434347,0.9852380454153296,1.0,0.9982256152886956,0.9973877352196069,0.7792627684518)
H9_FT2_genome_decile_5 <- c(0.0,0.1340922735644582,0.22031585481261384,0.2734728765785109,0.31943260101960863,0.3567159850620211,0.3654930652366367,0.3941143549092833,0.4113540850487927,0.43461988542122454,0.46515319568955865,0.4848116980248898,0.5000315447783216,0.524815564804168,0.5337686851932881,0.542720788008914,0.552050410590905,0.5683702542916163,0.5776388224639525,0.5851663223876344,0.5747692652101798,0.57719363406022,0.5777721245916987,0.5934208785729549,0.6061054409654737,0.6087190784854436,0.5987901051153419,0.6091815656385783,0.6163264579284239,0.6224863390758397,0.6272984441301273,0.6266553376817641,0.6199342647522718,0.6374492485219745,0.6394228323140639,0.6328075870279731,0.6239842072593693,0.6310772033010084,0.6333575855016128,0.6284299858557284,0.6400847638720707,0.6499847363975864,0.6561278275823471,0.6668438940502478,0.6619300316465356,0.6728572446144923,0.6594079757410479,0.6685895413796261,0.6592370233940147,0.6861029987890875,0.6819614746675079,0.6821970429314257,0.6951761928505287,0.6903132091215288,0.6859813987565252,0.708728745433639,0.7096796678640115,0.7077600154671171,0.7009605893785679,0.7087816592553398,0.7147990801135612,0.7220146937612569,0.7203214514668322,0.721236250038159,0.7258199098429884,0.7335743286558871,0.745015925025185,0.7532475858068849,0.7594863289001048,0.7538504981022255,0.7698701576221343,0.764694778830401,0.767085058968384,0.7857946740203311,0.7937576953995502,0.7976153165162354,0.8044447610228649,0.7998829790481617,0.8100108880363884,0.8101365583629278,0.8261959032491122,0.843864540616446,0.8490246558057656,0.8602973349750186,0.8746812451029276,0.8819589307337723,0.8884449441860939,0.9005103131073642,0.9109323008354279,0.9264925259226847,0.9390554882826412,0.9553626123146745,0.9719460075503953,0.9820784956193461,0.9791662002788152,0.9983337234031728,1.0,0.9969254016871368,0.9903808777588962,0.7802667060128418)
H9_FT2_genome_decile_7 <- c(0.0,0.14868630573248406,0.22677627140504394,0.289645216977201,0.3213212095958093,0.350076641466754,0.37708779788479474,0.39678391074865565,0.41725883981189354,0.4378274004405024,0.4490712492807111,0.45992693017441516,0.4648918834454432,0.4814888535031847,0.5047435859277338,0.5176399388852511,0.5208984413754787,0.5297698771752287,0.5375933835347342,0.5613733208325893,0.5759848056431931,0.5917651348294541,0.5861230579201143,0.5938039466634919,0.608970400023811,0.6212547373851618,0.6114135017957418,0.6215033880984979,0.6261992281286585,0.6374567186538881,0.6431130573248408,0.6493652896005715,0.6554966069408893,0.6640642052106276,0.6635129571204635,0.6645621267138917,0.6578932029684307,0.6646731204238348,0.6580910074012342,0.656832871996349,0.653923472627339,0.656272322757307,0.6584277089906145,0.6649068892989662,0.6696393138480465,0.6733442714844138,0.6789968896958152,0.6857098388792984,0.6867726501577475,0.696322449748993,0.7061128390578805,0.7052112476933151,0.7092287239319801,0.6996541212770602,0.7070770581582237,0.7199461277456991,0.7174881441355636,0.7242209357699864,0.7301451475286227,0.7347820802825565,0.7421845546361887,0.7498021955671964,0.751623980594083,0.7504365339206699,0.7650461585014982,0.7664884566541659,0.7726712403516083,0.7892316258904299,0.7891299333293649,0.7954578149493026,0.801123454769133,0.8100730202194575,0.8226500337321666,0.8258521092525348,0.8365149463261702,0.8419027918328472,0.8522369883127964,0.8605646169414846,0.8754433547631804,0.8858445195150505,0.8899717493104748,0.8943749131892771,0.9026647171458618,0.9147847342103697,0.9313792239617438,0.9392312538444749,0.949685745183245,0.9697359217810584,0.9708892642419191,0.9638588358434034,0.9567521380240888,0.9582099380915531,0.9732188919975395,0.9763688810841915,0.9763347768716392,0.9898109014425461,0.9952626148381848,0.9889638768180645,1.0,0.866733758953906)
H9_FT2_genome_decile_6 <- c(0.0,0.14035536405525958,0.24432718560412076,0.30064755200324983,0.34861544501628944,0.38551668234406766,0.4051996128435379,0.42671057577448324,0.4469799380871672,0.47118774425628124,0.48260737368339246,0.5055481898949191,0.5222432286322392,0.537177114173382,0.5588057350182772,0.5784515103870265,0.5853691764751051,0.6033274896569405,0.60936953316436,0.6234377041597027,0.6345210796537885,0.6395103944574453,0.6328912079194923,0.6451982257186576,0.6587610869361941,0.6666231125967659,0.6480121076185976,0.6633782311804618,0.6621366305622005,0.6639039762801645,0.6753428025248149,0.6775058503849581,0.6772686768005222,0.6814263359282063,0.6797110073932517,0.6779120798141748,0.6841058401053719,0.6909516729407233,0.6882746457722725,0.6832011126723146,0.686419985497114,0.6916724824767114,0.6997450538780358,0.6969559420652431,0.6936571857093936,0.7003946494134753,0.7093781407696438,0.7028214987017378,0.7015377889353259,0.7136565540721713,0.7148219866724546,0.71594407162023,0.7184049797783201,0.7241274891615388,0.7193177574897003,0.7395908353154563,0.7382575853747497,0.7459053497814969,0.7512160564658906,0.75651004334146,0.7610256302284235,0.7576005464281225,0.7579355618567905,0.7550343653996561,0.7577200620986084,0.763513166230197,0.7732589570183255,0.777678559817593,0.7888306723035128,0.7874800833018031,0.7929282639698647,0.7931357134497239,0.8021873225455476,0.8028078132285889,0.8119355903423907,0.824074171548954,0.8325498761186017,0.8305335910248066,0.8391498658390155,0.8457882491945077,0.8543419795386695,0.8713924690265542,0.879305273365778,0.893172806655227,0.9057436258825118,0.9085965206697089,0.9203598350559897,0.9341902132147176,0.9447162617479878,0.954713468920662,0.9610360336650254,0.9752249588352114,0.976187895973065,0.9743555287763391,0.9832529440796705,0.9912406779325151,0.994693628080857,0.9966777120613605,1.0,0.8237484449029663)
H9_FT2_genome_decile_9 <- c(0.0,0.18339882179733893,0.27711251894382405,0.33834112053087917,0.383730621278804,0.42036026190143905,0.45088758326928635,0.4837864453621784,0.504847260197232,0.5269144810424164,0.5338934742825917,0.5410415122822811,0.5463123671966679,0.5618654678903411,0.5741094191346874,0.5762676882736009,0.5879062234024779,0.5962985094576612,0.6055320880369383,0.6160354679493102,0.6214095187924701,0.6316327954696005,0.6345350581140502,0.6427406086790725,0.6462581156226842,0.656940368478263,0.6499171484114706,0.6552341957892129,0.6590868437967453,0.6608559168614285,0.6631596431189938,0.6597414008306781,0.6696708148153973,0.6730694007363275,0.673986370274855,0.6748895803562127,0.6826911925714656,0.6787363314535294,0.6840071863679161,0.6794724624121115,0.6820346699007943,0.6893861513029224,0.6923896442394067,0.6949862503710139,0.6961921685101063,0.704765293145235,0.7053667779872272,0.7096901959936393,0.7104273097705905,0.7213778720409796,0.7269416068294083,0.7263086717995993,0.7298920275739522,0.7319254787799686,0.7388376403710336,0.7459100013562894,0.740654871535811,0.7525970975407918,0.745055932193395,0.7562689069683788,0.7598729019284862,0.7576320760465541,0.7639584778895352,0.7706839039904392,0.7769818041007114,0.7806909606263305,0.7836227078218583,0.7885908546785103,0.7983600692690387,0.8017183596368289,0.7949457582542001,0.8031680167315,0.8113853611169535,0.8059739631757613,0.8163220577857888,0.8147908267664686,0.8204213932040075,0.8316363336157299,0.8390939594017388,0.844033604525682,0.8384708525556226,0.8455137289898003,0.8657538904865147,0.8747270221979356,0.8877208638580338,0.90541945705182,0.914099708889199,0.9229381944840301,0.9318749619157882,0.9380352674543628,0.9545928085214284,0.9619993277522354,0.9711218478557851,0.9743278013763389,0.9872135330158175,0.9901256238439599,0.993421013836117,1.0,0.9919585801026456,0.8435569376165868)
H9_FT2_genome_decile_10 <- c(0.0,0.2531207391816581,0.3790291621990125,0.4549395708404485,0.5198810611175092,0.550944495188171,0.5809985703506612,0.6236166818897846,0.654868750248203,0.6710681333809884,0.6743030459473413,0.6857369312841692,0.6959728234250692,0.7092864328925248,0.7227009782507976,0.7346395430417113,0.7446553618468952,0.7504732404061263,0.763723971777663,0.7799696861390202,0.7862574957309082,0.7901294626901235,0.7822051679176099,0.7784937055716612,0.7896959347656302,0.7863369206941742,0.7725351786399799,0.7889265054339912,0.7777358590471652,0.7875398779503064,0.7643941199052195,0.7705478998715963,0.7730365487205962,0.7764236924665422,0.7762400222389897,0.7787568007624797,0.7939484796738282,0.7824682631084283,0.7906424155778828,0.774355334048158,0.7776448512767563,0.7725997114226335,0.7766023986338906,0.7792598255298306,0.7833932329931298,0.7771616827502217,0.7668364375256477,0.755298306924533,0.7452907615530228,0.7650808149001231,0.7675760824960618,0.766364851806256,0.7557185973551487,0.7434242749162728,0.7542194511735039,0.7514594337000119,0.7483966085540685,0.750542737248984,0.7470281826244656,0.7565078829276042,0.7531918907112506,0.7477463166673285,0.7486067537693764,0.7497617251102021,0.7726625895185524,0.7710707808797639,0.7865801596441762,0.7831632315370054,0.7846689964655892,0.7935066783156612,0.7982241901963121,0.8040950187310538,0.8077700779688389,0.8072836000688349,0.8220003838873224,0.8327872867108799,0.8344651390598732,0.8377050156864303,0.846092622744662,0.8443254173119945,0.8317282872006672,0.8534460505937016,0.867891465787697,0.8771593661887931,0.903172696345128,0.9094092106482401,0.9021103874614458,0.8982119455144753,0.9239588711065221,0.9283818487483949,0.955937346941477,0.9566968481527077,0.9584607442119059,0.9729723468752896,1.0,0.9895241782825676,0.9792800127079941,0.9696712468395483,0.9784625974610487,0.769503792541996)
H9_FT2_genome_decile_8 <- c(0.0,0.20409257176889947,0.3167227424853218,0.38781828768006116,0.4446822790042357,0.48977790420146405,0.5135528660891672,0.5413030627619526,0.5803060539661233,0.6031938771428444,0.6192886000897806,0.6299742658660492,0.6378287324494539,0.6570159960532106,0.6787064486450689,0.6985772890712155,0.7069162151711387,0.7130319609943421,0.7297267026085256,0.7338832763685982,0.7391136613139075,0.7460169871951572,0.7529425359900086,0.7638993213122186,0.7782019885063091,0.7950451791833524,0.7848626401710276,0.7964221109101172,0.7977074842328428,0.7885898672403141,0.7945989430782291,0.779112239047437,0.8034223286946705,0.8024782993248679,0.8044543608023361,0.8012098154164796,0.8127577302404964,0.8084287066708742,0.809185174649878,0.8008515820492194,0.7971065766490513,0.8000248896632339,0.811930148937967,0.8029965376700609,0.7992115310254096,0.8166351842057309,0.833059695190517,0.8276613050183783,0.8258816940971497,0.8370482637237603,0.827682639015436,0.8223313614201331,0.831870324854551,0.8334721524669656,0.8392225535905562,0.8512504833483708,0.8512380385167538,0.8449453983012805,0.8487090709488739,0.8480637175378789,0.8471321329996934,0.8268826141257728,0.836627806198415,0.8263137075375678,0.8287333383705271,0.8271377331739209,0.8257652460298764,0.8287431164525119,0.8360215651153592,0.8383123030494282,0.848633513042628,0.8549554875040557,0.8596907459343179,0.8521989573008938,0.8613814652011396,0.8643291124612765,0.8605156604872152,0.8625041667963004,0.869723946967239,0.8786886703141875,0.8886347575257897,0.9008493597578592,0.9091305062824176,0.9235389545452525,0.927404852595414,0.9319747725484793,0.9374371647117911,0.9465414479561587,0.9567008751383377,0.9643713359971199,0.9747565479814928,0.9687039152329183,0.9767130532949914,0.9759512518167232,0.9804207242003085,0.9846955238607423,0.9930735622886045,0.9957412008373594,1.0,0.8351744276488602)
data_matrix <- matrix(c(H9_FT2_genome_decile_1,H9_FT2_genome_decile_2,H9_FT2_genome_decile_4,H9_FT2_genome_decile_5,H9_FT2_genome_decile_7,H9_FT2_genome_decile_6,H9_FT2_genome_decile_9,H9_FT2_genome_decile_10,H9_FT2_genome_decile_8), byrow=T, ncol=100)
rowLabel <- c("H9_FT2_genome_decile_1","H9_FT2_genome_decile_2","H9_FT2_genome_decile_4","H9_FT2_genome_decile_5","H9_FT2_genome_decile_7","H9_FT2_genome_decile_6","H9_FT2_genome_decile_9","H9_FT2_genome_decile_10","H9_FT2_genome_decile_8")


pdf("/users/sparthib/retina_lrs/plots/coverage/H9_FT2_deciles.geneBodyCoverage.heatMap.pdf")
rc <- cm.colors(ncol(data_matrix))
heatmap(data_matrix, scale=c("none"),keep.dendro=F, labRow = rowLabel ,Colv = NA,Rowv = NA,labCol=NA,col=cm.colors(256),margins = c(6, 8),ColSideColors = rc,cexRow=1,cexCol=1,xlab="Gene body percentile (5'->3')", add.expr=x_axis_expr <- axis(side=1,at=c(1,10,20,30,40,50,60,70,80,90,100),labels=c("1","10","20","30","40","50","60","70","80","90","100")))
dev.off()


pdf("/users/sparthib/retina_lrs/plots/coverage/H9_FT2_deciles.geneBodyCoverage.curves.pdf")
x=1:100
icolor = colorRampPalette(c("#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f"))(9)
layout(matrix(c(1,1,1,2,1,1,1,2,1,1,1,2), 4, 4, byrow = TRUE))
plot(x,H9_FT2_genome_decile_1,type='l',xlab="Gene body percentile (5'->3')", ylab="Coverage",lwd=0.8,col=icolor[1])
lines(x,H9_FT2_genome_decile_2,type='l',col=icolor[2])
lines(x,H9_FT2_genome_decile_4,type='l',col=icolor[3])
lines(x,H9_FT2_genome_decile_5,type='l',col=icolor[4])
lines(x,H9_FT2_genome_decile_7,type='l',col=icolor[5])
lines(x,H9_FT2_genome_decile_6,type='l',col=icolor[6])
lines(x,H9_FT2_genome_decile_9,type='l',col=icolor[7])
lines(x,H9_FT2_genome_decile_10,type='l',col=icolor[8])
lines(x,H9_FT2_genome_decile_8,type='l',col=icolor[9])
par(mar=c(1,0,2,1))
plot.new()
legend(0,1,fill=icolor[1:9],legend=c('H9_FT2_genome_decile_1','H9_FT2_genome_decile_2','H9_FT2_genome_decile_4','H9_FT2_genome_decile_5','H9_FT2_genome_decile_7','H9_FT2_genome_decile_6','H9_FT2_genome_decile_9','H9_FT2_genome_decile_10','H9_FT2_genome_decile_8'))
dev.off()
